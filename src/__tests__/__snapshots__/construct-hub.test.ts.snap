// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`minimal usage 1`] = `
Object {
  "Outputs": Object {
    "ConstructHubMonitoringWatchfulWatchfulDashboard75D318D0": Object {
      "Value": Object {
        "Fn::Join": Array [
          "",
          Array [
            "https://console.aws.amazon.com/cloudwatch/home?region=",
            Object {
              "Ref": "AWS::Region",
            },
            "#dashboards:name=",
            Object {
              "Ref": "ConstructHubMonitoringWatchfulDashboardB8493D55",
            },
          ],
        ],
      },
    },
    "ConstructHubWebAppDomainNameDC10F8DD": Object {
      "Export": Object {
        "Name": "ConstructHubDomainName",
      },
      "Value": Object {
        "Fn::GetAtt": Array [
          "ConstructHubWebAppDistribution1F181DC9",
          "DomainName",
        ],
      },
    },
  },
  "Parameters": Object {
    "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dArtifactHashFECDD477": Object {
      "Description": "Artifact hash for asset \\"0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963d\\"",
      "Type": "String",
    },
    "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dS3Bucket7B3413EA": Object {
      "Description": "S3 bucket for asset \\"0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963d\\"",
      "Type": "String",
    },
    "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dS3VersionKeyE2914469": Object {
      "Description": "S3 key for asset version \\"0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963d\\"",
      "Type": "String",
    },
    "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bArtifactHashD350A16C": Object {
      "Description": "Artifact hash for asset \\"29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780b\\"",
      "Type": "String",
    },
    "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bS3Bucket3171CA99": Object {
      "Description": "S3 bucket for asset \\"29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780b\\"",
      "Type": "String",
    },
    "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bS3VersionKeyB69597A2": Object {
      "Description": "S3 key for asset version \\"29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780b\\"",
      "Type": "String",
    },
    "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236ArtifactHashE5BF8317": Object {
      "Description": "Artifact hash for asset \\"3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236\\"",
      "Type": "String",
    },
    "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236S3BucketD05214B3": Object {
      "Description": "S3 bucket for asset \\"3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236\\"",
      "Type": "String",
    },
    "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236S3VersionKey29F1A337": Object {
      "Description": "S3 key for asset version \\"3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236\\"",
      "Type": "String",
    },
    "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5ArtifactHash76FE5C86": Object {
      "Description": "Artifact hash for asset \\"59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5\\"",
      "Type": "String",
    },
    "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5S3BucketFA2341B6": Object {
      "Description": "S3 bucket for asset \\"59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5\\"",
      "Type": "String",
    },
    "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5S3VersionKeyB4EE9C49": Object {
      "Description": "S3 key for asset version \\"59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5\\"",
      "Type": "String",
    },
    "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24ArtifactHashBA91B77F": Object {
      "Description": "Artifact hash for asset \\"67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24\\"",
      "Type": "String",
    },
    "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3Bucket4D46ABB5": Object {
      "Description": "S3 bucket for asset \\"67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24\\"",
      "Type": "String",
    },
    "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3VersionKeyB0F28861": Object {
      "Description": "S3 key for asset version \\"67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24\\"",
      "Type": "String",
    },
    "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784ArtifactHash1A2C2611": Object {
      "Description": "Artifact hash for asset \\"97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784\\"",
      "Type": "String",
    },
    "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784S3BucketE5876F15": Object {
      "Description": "S3 bucket for asset \\"97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784\\"",
      "Type": "String",
    },
    "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784S3VersionKey267A8045": Object {
      "Description": "S3 key for asset version \\"97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784\\"",
      "Type": "String",
    },
    "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91ArtifactHash2FEFFD84": Object {
      "Description": "Artifact hash for asset \\"b175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91\\"",
      "Type": "String",
    },
    "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3Bucket7E2DA7AC": Object {
      "Description": "S3 bucket for asset \\"b175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91\\"",
      "Type": "String",
    },
    "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3VersionKeyDEDF4AE1": Object {
      "Description": "S3 key for asset version \\"b175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91\\"",
      "Type": "String",
    },
    "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaArtifactHashE807E7D1": Object {
      "Description": "Artifact hash for asset \\"ba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892ea\\"",
      "Type": "String",
    },
    "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaS3Bucket03A867A5": Object {
      "Description": "S3 bucket for asset \\"ba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892ea\\"",
      "Type": "String",
    },
    "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaS3VersionKeyC53D0DC5": Object {
      "Description": "S3 key for asset version \\"ba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892ea\\"",
      "Type": "String",
    },
    "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfArtifactHash85F58E48": Object {
      "Description": "Artifact hash for asset \\"c24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cf\\"",
      "Type": "String",
    },
    "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfS3Bucket55EFA30C": Object {
      "Description": "S3 bucket for asset \\"c24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cf\\"",
      "Type": "String",
    },
    "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfS3VersionKey60329B70": Object {
      "Description": "S3 key for asset version \\"c24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cf\\"",
      "Type": "String",
    },
    "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68ArtifactHashD9A515C3": Object {
      "Description": "Artifact hash for asset \\"e9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68\\"",
      "Type": "String",
    },
    "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68S3BucketAEADE8C7": Object {
      "Description": "S3 bucket for asset \\"e9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68\\"",
      "Type": "String",
    },
    "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68S3VersionKeyE415415F": Object {
      "Description": "S3 key for asset version \\"e9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68\\"",
      "Type": "String",
    },
    "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797ArtifactHashAAFCA968": Object {
      "Description": "Artifact hash for asset \\"f3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797\\"",
      "Type": "String",
    },
    "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797S3BucketBEE108A9": Object {
      "Description": "S3 bucket for asset \\"f3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797\\"",
      "Type": "String",
    },
    "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797S3VersionKeyA877E3C9": Object {
      "Description": "S3 key for asset version \\"f3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797\\"",
      "Type": "String",
    },
  },
  "Resources": Object {
    "AWS679f53fac002430cb0da5b7982bd22872D164C4C": Object {
      "DependsOn": Array [
        "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797S3BucketBEE108A9",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797S3VersionKeyA877E3C9",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797S3VersionKeyA877E3C9",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
            "Arn",
          ],
        },
        "Runtime": "nodejs12.x",
        "Timeout": 120,
      },
      "Type": "AWS::Lambda::Function",
    },
    "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db8347ECC3691": Object {
      "DependsOn": Array [
        "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36",
        "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC",
      ],
      "Properties": Object {
        "Code": Object {
          "ZipFile": "import boto3  # type: ignore
import json
import logging
import urllib.request

s3 = boto3.client(\\"s3\\")

CONFIGURATION_TYPES = [\\"TopicConfigurations\\", \\"QueueConfigurations\\", \\"LambdaFunctionConfigurations\\"]

def handler(event: dict, context):
    response_status = \\"SUCCESS\\"
    error_message = \\"\\"
    try:
        props = event[\\"ResourceProperties\\"]
        bucket = props[\\"BucketName\\"]
        notification_configuration = props[\\"NotificationConfiguration\\"]
        request_type = event[\\"RequestType\\"]
        managed = props.get('Managed', 'true').lower() == 'true'
        stack_id = event['StackId']

        if managed:
          config = handle_managed(request_type, notification_configuration)
        else:
          config = handle_unmanaged(bucket, stack_id, request_type, notification_configuration)

        put_bucket_notification_configuration(bucket, config)
    except Exception as e:
        logging.exception(\\"Failed to put bucket notification configuration\\")
        response_status = \\"FAILED\\"
        error_message = f\\"Error: {str(e)}. \\"
    finally:
        submit_response(event, context, response_status, error_message)


def handle_managed(request_type, notification_configuration):
  if request_type == 'Delete':
    return {}
  return notification_configuration


def handle_unmanaged(bucket, stack_id, request_type, notification_configuration):

  # find external notifications
  external_notifications = find_external_notifications(bucket, stack_id)

  # if delete, that's all we need
  if request_type == 'Delete':
    return external_notifications

  def with_id(notification):
    notification['Id'] = f\\"{stack_id}-{hash(json.dumps(notification, sort_keys=True))}\\"
    return notification

  # otherwise, merge external with incoming config and augment with id
  notifications = {}
  for t in CONFIGURATION_TYPES:
    external = external_notifications.get(t, [])
    incoming = [with_id(n) for n in notification_configuration.get(t, [])]
    notifications[t] = external + incoming
  return notifications


def find_external_notifications(bucket, stack_id):
  existing_notifications = get_bucket_notification_configuration(bucket)
  external_notifications = {}
  for t in CONFIGURATION_TYPES:
    # if the notification was created by us, we know what id to expect
    # so we can filter by it.
    external_notifications[t] = [n for n in existing_notifications.get(t, []) if not n['Id'].startswith(f\\"{stack_id}-\\")]

  return external_notifications


def get_bucket_notification_configuration(bucket):
  return s3.get_bucket_notification_configuration(Bucket=bucket)


def put_bucket_notification_configuration(bucket, notification_configuration):
  s3.put_bucket_notification_configuration(Bucket=bucket, NotificationConfiguration=notification_configuration)


def submit_response(event: dict, context, response_status: str, error_message: str):
    response_body = json.dumps(
        {
            \\"Status\\": response_status,
            \\"Reason\\": f\\"{error_message}See the details in CloudWatch Log Stream: {context.log_stream_name}\\",
            \\"PhysicalResourceId\\": event.get(\\"PhysicalResourceId\\") or event[\\"LogicalResourceId\\"],
            \\"StackId\\": event[\\"StackId\\"],
            \\"RequestId\\": event[\\"RequestId\\"],
            \\"LogicalResourceId\\": event[\\"LogicalResourceId\\"],
            \\"NoEcho\\": False,
        }
    ).encode(\\"utf-8\\")
    headers = {\\"content-type\\": \\"\\", \\"content-length\\": str(len(response_body))}
    try:
        req = urllib.request.Request(url=event[\\"ResponseURL\\"], headers=headers, data=response_body, method=\\"PUT\\")
        with urllib.request.urlopen(req) as response:
            print(response.read().decode(\\"utf-8\\"))
        print(\\"Status code: \\" + response.reason)
    except Exception as e:
        print(\\"send(..) failed executing request.urlopen(..): \\" + str(e))
",
        },
        "Description": "AWS CloudFormation handler for \\"Custom::S3BucketNotifications\\" resources (@aws-cdk/aws-s3)",
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC",
            "Arn",
          ],
        },
        "Runtime": "python3.8",
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "s3:PutBucketNotification",
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36",
        "Roles": Array [
          Object {
            "Ref": "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubCatalogBuilder5A9DE4AF": Object {
      "DependsOn": Array [
        "ConstructHubCatalogBuilderServiceRoleDefaultPolicyF51442BC",
        "ConstructHubCatalogBuilderServiceRole7EB4C395",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bS3Bucket3171CA99",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bS3VersionKeyB69597A2",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bS3VersionKeyB69597A2",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "DeadLetterConfig": Object {
          "TargetArn": Object {
            "Fn::GetAtt": Array [
              "ConstructHubCatalogBuilderDeadLetterQueue1D42C407",
              "Arn",
            ],
          },
        },
        "Description": Object {
          "Fn::Join": Array [
            "",
            Array [
              "Creates the catalog.json object in ",
              Object {
                "Ref": "ConstructHubPackageDataDC5EF35E",
              },
            ],
          ],
        },
        "Environment": Object {
          "Variables": Object {
            "BUCKET_NAME": Object {
              "Ref": "ConstructHubPackageDataDC5EF35E",
            },
          },
        },
        "Handler": "index.handler",
        "MemorySize": 10240,
        "ReservedConcurrentExecutions": 1,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubCatalogBuilderServiceRole7EB4C395",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubCatalogBuilderDLQAlarm9D928A2B": Object {
      "Properties": Object {
        "AlarmDescription": "The catalog builder function failed to run",
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "Dimensions": Array [
          Object {
            "Name": "QueueName",
            "Value": Object {
              "Fn::GetAtt": Array [
                "ConstructHubCatalogBuilderDeadLetterQueue1D42C407",
                "QueueName",
              ],
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "ApproximateNumberOfMessagesVisible",
        "Namespace": "AWS/SQS",
        "Period": 300,
        "Statistic": "Maximum",
        "Threshold": 1,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubCatalogBuilderDeadLetterQueue1D42C407": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "MessageRetentionPeriod": 1209600,
      },
      "Type": "AWS::SQS::Queue",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubCatalogBuilderLogRetentionD5D7858F": Object {
      "Properties": Object {
        "LogGroupName": Object {
          "Fn::Join": Array [
            "",
            Array [
              "/aws/lambda/",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A",
            "Arn",
          ],
        },
      },
      "Type": "Custom::LogRetention",
    },
    "ConstructHubCatalogBuilderServiceRole7EB4C395": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubCatalogBuilderServiceRoleDefaultPolicyF51442BC": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sqs:SendMessage",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCatalogBuilderDeadLetterQueue1D42C407",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubCatalogBuilderServiceRoleDefaultPolicyF51442BC",
        "Roles": Array [
          Object {
            "Ref": "ConstructHubCatalogBuilderServiceRole7EB4C395",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubCodeArtifact1188409E": Object {
      "Properties": Object {
        "Description": "Proxy to npmjs.com for ConstructHub",
        "DomainName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubCodeArtifactDomainFC30B796",
            "Name",
          ],
        },
        "ExternalConnections": Array [
          "public:npmjs",
        ],
        "RepositoryName": "c857fcb69e05ffe74ccbcc624c4f6a4017daeb8cbb",
      },
      "Type": "AWS::CodeArtifact::Repository",
    },
    "ConstructHubCodeArtifactDescribeDomain6ABCBF4B": Object {
      "DeletionPolicy": "Delete",
      "DependsOn": Array [
        "ConstructHubCodeArtifactDescribeDomainCustomResourcePolicy1A93C60C",
      ],
      "Properties": Object {
        "Create": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"service\\":\\"CodeArtifact\\",\\"action\\":\\"describeDomain\\",\\"parameters\\":{\\"domain\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifactDomainFC30B796",
                  "Name",
                ],
              },
              "\\",\\"domainOwner\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifactDomainFC30B796",
                  "Owner",
                ],
              },
              "\\"},\\"physicalResourceId\\":{\\"responsePath\\":\\"domain.s3BucketArn\\"}}",
            ],
          ],
        },
        "InstallLatestAwsSdk": true,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "AWS679f53fac002430cb0da5b7982bd22872D164C4C",
            "Arn",
          ],
        },
      },
      "Type": "Custom::AWS",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubCodeArtifactDescribeDomainCustomResourcePolicy1A93C60C": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "codeartifact:DescribeDomain",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifactDomainFC30B796",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubCodeArtifactDescribeDomainCustomResourcePolicy1A93C60C",
        "Roles": Array [
          Object {
            "Ref": "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubCodeArtifactDomainFC30B796": Object {
      "Properties": Object {
        "DomainName": "c857fcb69e05ffe74ccbcc624c4f6a4017daeb8cbb",
      },
      "Type": "AWS::CodeArtifact::Domain",
    },
    "ConstructHubCodeArtifactGetEndpoint9A458FEF": Object {
      "DeletionPolicy": "Delete",
      "DependsOn": Array [
        "ConstructHubCodeArtifactGetEndpointCustomResourcePolicy4FC951E9",
      ],
      "Properties": Object {
        "Create": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"service\\":\\"CodeArtifact\\",\\"action\\":\\"getRepositoryEndpoint\\",\\"parameters\\":{\\"domain\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "DomainName",
                ],
              },
              "\\",\\"domainOwner\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "DomainOwner",
                ],
              },
              "\\",\\"format\\":\\"npm\\",\\"repository\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "Name",
                ],
              },
              "\\"},\\"physicalResourceId\\":{\\"responsePath\\":\\"repositoryEndpoint\\"}}",
            ],
          ],
        },
        "InstallLatestAwsSdk": true,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "AWS679f53fac002430cb0da5b7982bd22872D164C4C",
            "Arn",
          ],
        },
        "Update": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"service\\":\\"CodeArtifact\\",\\"action\\":\\"getRepositoryEndpoint\\",\\"parameters\\":{\\"domain\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "DomainName",
                ],
              },
              "\\",\\"domainOwner\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "DomainOwner",
                ],
              },
              "\\",\\"format\\":\\"npm\\",\\"repository\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "Name",
                ],
              },
              "\\"},\\"physicalResourceId\\":{\\"responsePath\\":\\"repositoryEndpoint\\"}}",
            ],
          ],
        },
      },
      "Type": "Custom::AWS",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubCodeArtifactGetEndpointCustomResourcePolicy4FC951E9": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "codeartifact:GetRepositoryEndpoint",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubCodeArtifactGetEndpointCustomResourcePolicy4FC951E9",
        "Roles": Array [
          Object {
            "Ref": "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubDiscoveryD6EEC2B8": Object {
      "DependsOn": Array [
        "ConstructHubDiscoveryServiceRoleDefaultPolicy9D5F91B3",
        "ConstructHubDiscoveryServiceRole1B3CFF96",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dS3Bucket7B3413EA",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dS3VersionKeyE2914469",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dS3VersionKeyE2914469",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Description": "Periodically query npm.js index for new construct libraries",
        "Environment": Object {
          "Variables": Object {
            "BUCKET_NAME": Object {
              "Ref": "ConstructHubDiscoveryStagingBucket1F2F7AE8",
            },
            "QUEUE_URL": Object {
              "Ref": "ConstructHubIngestionQueue1AD94CA3",
            },
          },
        },
        "Handler": "index.handler",
        "MemorySize": 10240,
        "ReservedConcurrentExecutions": 1,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubDiscoveryServiceRole1B3CFF96",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubDiscoveryErrorsAlarmDEA85148": Object {
      "Properties": Object {
        "AlarmDescription": "The discovery function (on npmjs.com) failed to run",
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubDiscoveryD6EEC2B8",
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 900,
        "Statistic": "Sum",
        "Threshold": 1,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubDiscoveryNoInvocationsAlarm6F5E3A99": Object {
      "Properties": Object {
        "AlarmDescription": "The discovery function (on npmjs.com) is not running as scheduled",
        "ComparisonOperator": "LessThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubDiscoveryD6EEC2B8",
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "Invocations",
        "Namespace": "AWS/Lambda",
        "Period": 900,
        "Statistic": "Sum",
        "Threshold": 1,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubDiscoveryScheduleRule90EE2E2A": Object {
      "Properties": Object {
        "ScheduleExpression": "rate(15 minutes)",
        "State": "ENABLED",
        "Targets": Array [
          Object {
            "Arn": Object {
              "Fn::GetAtt": Array [
                "ConstructHubDiscoveryD6EEC2B8",
                "Arn",
              ],
            },
            "Id": "Target0",
          },
        ],
      },
      "Type": "AWS::Events::Rule",
    },
    "ConstructHubDiscoveryScheduleRuleAllowEventRuleTestConstructHubDiscovery5714D5BB9D860B10": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubDiscoveryD6EEC2B8",
            "Arn",
          ],
        },
        "Principal": "events.amazonaws.com",
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubDiscoveryScheduleRule90EE2E2A",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubDiscoveryServiceRole1B3CFF96": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubDiscoveryServiceRoleDefaultPolicy9D5F91B3": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubDiscoveryStagingBucket1F2F7AE8",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubDiscoveryStagingBucket1F2F7AE8",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "sqs:SendMessage",
                "sqs:GetQueueAttributes",
                "sqs:GetQueueUrl",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubIngestionQueue1AD94CA3",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubDiscoveryServiceRoleDefaultPolicy9D5F91B3",
        "Roles": Array [
          Object {
            "Ref": "ConstructHubDiscoveryServiceRole1B3CFF96",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubDiscoveryStagingBucket1F2F7AE8": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "LifecycleConfiguration": Object {
          "Rules": Array [
            Object {
              "ExpirationInDays": 30,
              "Prefix": "staged/",
              "Status": "Enabled",
            },
          ],
        },
        "PublicAccessBlockConfiguration": Object {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true,
        },
      },
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
    },
    "ConstructHubIngestion407909CE": Object {
      "DependsOn": Array [
        "ConstructHubIngestionServiceRoleDefaultPolicyC0D2B6F2",
        "ConstructHubIngestionServiceRole6380BAB6",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236S3BucketD05214B3",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236S3VersionKey29F1A337",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236S3VersionKey29F1A337",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "DeadLetterConfig": Object {
          "TargetArn": Object {
            "Fn::GetAtt": Array [
              "ConstructHubIngestionDeadLetterQueueFC1025F8",
              "Arn",
            ],
          },
        },
        "Description": "Ingests new package versions into the Construct Hub",
        "Environment": Object {
          "Variables": Object {
            "BUCKET_NAME": Object {
              "Ref": "ConstructHubPackageDataDC5EF35E",
            },
          },
        },
        "Handler": "index.handler",
        "MemorySize": 10240,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubIngestionServiceRole6380BAB6",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubIngestionDLQAlarm83BD1903": Object {
      "Properties": Object {
        "AlarmDescription": "The ingestion function failed for one or more packages",
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "Dimensions": Array [
          Object {
            "Name": "QueueName",
            "Value": Object {
              "Fn::GetAtt": Array [
                "ConstructHubIngestionDeadLetterQueueFC1025F8",
                "QueueName",
              ],
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "ApproximateNumberOfMessagesVisible",
        "Namespace": "AWS/SQS",
        "Period": 300,
        "Statistic": "Maximum",
        "Threshold": 1,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubIngestionDeadLetterQueueFC1025F8": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "MessageRetentionPeriod": 1209600,
      },
      "Type": "AWS::SQS::Queue",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubIngestionEventInvokeConfig47AAD616": Object {
      "Properties": Object {
        "FunctionName": Object {
          "Ref": "ConstructHubIngestion407909CE",
        },
        "MaximumRetryAttempts": 2,
        "Qualifier": "$LATEST",
      },
      "Type": "AWS::Lambda::EventInvokeConfig",
    },
    "ConstructHubIngestionQueue1AD94CA3": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "KmsMasterKeyId": "alias/aws/sqs",
        "VisibilityTimeout": 900,
      },
      "Type": "AWS::SQS::Queue",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubIngestionServiceRole6380BAB6": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubIngestionServiceRoleDefaultPolicyC0D2B6F2": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sqs:SendMessage",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubIngestionDeadLetterQueueFC1025F8",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "sqs:ReceiveMessage",
                "sqs:ChangeMessageVisibility",
                "sqs:GetQueueUrl",
                "sqs:DeleteMessage",
                "sqs:GetQueueAttributes",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubIngestionQueue1AD94CA3",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubDiscoveryStagingBucket1F2F7AE8",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubDiscoveryStagingBucket1F2F7AE8",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubIngestionServiceRoleDefaultPolicyC0D2B6F2",
        "Roles": Array [
          Object {
            "Ref": "ConstructHubIngestionServiceRole6380BAB6",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubIngestionSqsEventSourceTestConstructHubIngestionQueue165B81E2C095FF2A": Object {
      "Properties": Object {
        "BatchSize": 1,
        "EventSourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubIngestionQueue1AD94CA3",
            "Arn",
          ],
        },
        "FunctionName": Object {
          "Ref": "ConstructHubIngestion407909CE",
        },
      },
      "Type": "AWS::Lambda::EventSourceMapping",
    },
    "ConstructHubInventoryCanary63D899BC": Object {
      "DependsOn": Array [
        "ConstructHubInventoryCanaryServiceRoleDefaultPolicy144783F1",
        "ConstructHubInventoryCanaryServiceRole7684EDDE",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784S3BucketE5876F15",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784S3VersionKey267A8045",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784S3VersionKey267A8045",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Description": "[ConstructHub/Inventory] A canary that periodically inspects the list of indexed packages",
        "Environment": Object {
          "Variables": Object {
            "BUCKET_NAME": Object {
              "Ref": "ConstructHubPackageDataDC5EF35E",
            },
          },
        },
        "Handler": "index.handler",
        "MemorySize": 10240,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubInventoryCanaryServiceRole7684EDDE",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubInventoryCanaryScheduleRule79F2F8D8": Object {
      "DependsOn": Array [
        "ConstructHubInventoryCanaryServiceRoleDefaultPolicy144783F1",
      ],
      "Properties": Object {
        "ScheduleExpression": "rate(5 minutes)",
        "State": "ENABLED",
        "Targets": Array [
          Object {
            "Arn": Object {
              "Fn::GetAtt": Array [
                "ConstructHubInventoryCanary63D899BC",
                "Arn",
              ],
            },
            "Id": "Target0",
          },
        ],
      },
      "Type": "AWS::Events::Rule",
    },
    "ConstructHubInventoryCanaryScheduleRuleAllowEventRuleTestConstructHubInventoryCanary54F5B7AC7EBA7AB2": Object {
      "DependsOn": Array [
        "ConstructHubInventoryCanaryServiceRoleDefaultPolicy144783F1",
      ],
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubInventoryCanary63D899BC",
            "Arn",
          ],
        },
        "Principal": "events.amazonaws.com",
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubInventoryCanaryScheduleRule79F2F8D8",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubInventoryCanaryServiceRole7684EDDE": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubInventoryCanaryServiceRoleDefaultPolicy144783F1": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubInventoryCanaryServiceRoleDefaultPolicy144783F1",
        "Roles": Array [
          Object {
            "Ref": "ConstructHubInventoryCanaryServiceRole7684EDDE",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubMonitoringDashboard78E057C8": Object {
      "Properties": Object {
        "DashboardBody": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"widgets\\":[{\\"type\\":\\"metric\\",\\"width\\":24,\\"height\\":6,\\"x\\":0,\\"y\\":0,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Home Page Canary\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"annotations\\":{\\"alarms\\":[\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubMonitoringWebCanaryHomePageErrorsE7BB4002",
                  "Arn",
                ],
              },
              "\\"]},\\"yAxis\\":{}}}]}",
            ],
          ],
        },
        "DashboardName": "construct-hub-high-severity",
      },
      "Type": "AWS::CloudWatch::Dashboard",
    },
    "ConstructHubMonitoringWatchfulDashboardB8493D55": Object {
      "Properties": Object {
        "DashboardBody": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"widgets\\":[{\\"type\\":\\"text\\",\\"width\\":24,\\"height\\":2,\\"x\\":0,\\"y\\":0,\\"properties\\":{\\"markdown\\":\\"# Ingestion Function\\\\n\\\\n[button:AWS Lambda Console](https://console.aws.amazon.com/lambda/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#/functions/",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              "?tab=graph) [button:CloudWatch Logs](https://console.aws.amazon.com/cloudwatch/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#logEventViewer:group=/aws/lambda/",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              ")\\"}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":0,\\"y\\":2,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Invocations/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Invocations\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":6,\\"y\\":2,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Errors/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Errors\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Errors > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":12,\\"y\\":2,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Throttles/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Throttles\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Throttles > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":18,\\"y\\":2,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Duration/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Duration\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              "\\",{\\"label\\":\\"p99\\",\\"stat\\":\\"p99\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"p99 > 720000 for 3 datapoints within 15 minutes\\",\\"value\\":720000,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"text\\",\\"width\\":24,\\"height\\":2,\\"x\\":0,\\"y\\":8,\\"properties\\":{\\"markdown\\":\\"# Discovery Function\\\\n\\\\n[button:AWS Lambda Console](https://console.aws.amazon.com/lambda/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#/functions/",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              "?tab=graph) [button:CloudWatch Logs](https://console.aws.amazon.com/cloudwatch/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#logEventViewer:group=/aws/lambda/",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              ")\\"}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":0,\\"y\\":10,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Invocations/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Invocations\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":6,\\"y\\":10,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Errors/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Errors\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Errors > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":12,\\"y\\":10,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Throttles/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Throttles\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Throttles > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":18,\\"y\\":10,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Duration/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Duration\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              "\\",{\\"label\\":\\"p99\\",\\"stat\\":\\"p99\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"p99 > 720000 for 3 datapoints within 15 minutes\\",\\"value\\":720000,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"text\\",\\"width\\":24,\\"height\\":2,\\"x\\":0,\\"y\\":16,\\"properties\\":{\\"markdown\\":\\"# Transliterator Function\\\\n\\\\n[button:AWS Lambda Console](https://console.aws.amazon.com/lambda/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#/functions/",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              "?tab=graph) [button:CloudWatch Logs](https://console.aws.amazon.com/cloudwatch/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#logEventViewer:group=/aws/lambda/",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              ")\\"}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":0,\\"y\\":18,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Invocations/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Invocations\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":6,\\"y\\":18,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Errors/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Errors\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Errors > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":12,\\"y\\":18,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Throttles/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Throttles\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Throttles > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":18,\\"y\\":18,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Duration/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Duration\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              "\\",{\\"label\\":\\"p99\\",\\"stat\\":\\"p99\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"p99 > 720000 for 3 datapoints within 15 minutes\\",\\"value\\":720000,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"text\\",\\"width\\":24,\\"height\\":2,\\"x\\":0,\\"y\\":24,\\"properties\\":{\\"markdown\\":\\"# Catalog Builder Function\\\\n\\\\n[button:AWS Lambda Console](https://console.aws.amazon.com/lambda/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#/functions/",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              "?tab=graph) [button:CloudWatch Logs](https://console.aws.amazon.com/cloudwatch/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#logEventViewer:group=/aws/lambda/",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              ")\\"}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":0,\\"y\\":26,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Invocations/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Invocations\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":6,\\"y\\":26,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Errors/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Errors\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Errors > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":12,\\"y\\":26,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Throttles/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Throttles\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Throttles > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":18,\\"y\\":26,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Duration/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Duration\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              "\\",{\\"label\\":\\"p99\\",\\"stat\\":\\"p99\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"p99 > 720000 for 3 datapoints within 15 minutes\\",\\"value\\":720000,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"text\\",\\"width\\":24,\\"height\\":2,\\"x\\":0,\\"y\\":32,\\"properties\\":{\\"markdown\\":\\"# Inventory Canary\\\\n\\\\n[button:AWS Lambda Console](https://console.aws.amazon.com/lambda/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#/functions/",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              "?tab=graph) [button:CloudWatch Logs](https://console.aws.amazon.com/cloudwatch/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#logEventViewer:group=/aws/lambda/",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              ")\\"}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":0,\\"y\\":34,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Invocations/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Invocations\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":6,\\"y\\":34,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Errors/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Errors\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Errors > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":12,\\"y\\":34,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Throttles/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Throttles\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Throttles > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":18,\\"y\\":34,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Duration/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Duration\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              "\\",{\\"label\\":\\"p99\\",\\"stat\\":\\"p99\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"p99 > 240000 for 3 datapoints within 15 minutes\\",\\"value\\":240000,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}}]}",
            ],
          ],
        },
        "DashboardName": "construct-hub",
      },
      "Type": "AWS::CloudWatch::Dashboard",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubCatalogBuilderC9A41048DurationAlarm557052D9": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "p99 latency >= 720s (80%)",
        "ComparisonOperator": "GreaterThanThreshold",
        "EvaluationPeriods": 3,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": "p99",
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
                    },
                  },
                ],
                "MetricName": "Duration",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "p99",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 720000,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubCatalogBuilderC9A41048ErrorsAlarmF91F07CD": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 errors per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubCatalogBuilderC9A41048ThrottlesAlarm2A5B0492": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 throttles per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Throttles",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubDiscovery5714D5BBDurationAlarm5CFE5B52": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "p99 latency >= 720s (80%)",
        "ComparisonOperator": "GreaterThanThreshold",
        "EvaluationPeriods": 3,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": "p99",
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubDiscoveryD6EEC2B8",
                    },
                  },
                ],
                "MetricName": "Duration",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "p99",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 720000,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubDiscovery5714D5BBErrorsAlarm373566EE": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 errors per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubDiscoveryD6EEC2B8",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubDiscovery5714D5BBThrottlesAlarm261A4778": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 throttles per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubDiscoveryD6EEC2B8",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Throttles",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubIngestionAE667A08DurationAlarm8C97ADAD": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "p99 latency >= 720s (80%)",
        "ComparisonOperator": "GreaterThanThreshold",
        "EvaluationPeriods": 3,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": "p99",
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubIngestion407909CE",
                    },
                  },
                ],
                "MetricName": "Duration",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "p99",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 720000,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubIngestionAE667A08ErrorsAlarm76E1369B": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 errors per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubIngestion407909CE",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubIngestionAE667A08ThrottlesAlarm2CD0B31C": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 throttles per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubIngestion407909CE",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Throttles",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubInventoryCanary54F5B7ACDurationAlarm2B1DCEF6": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "p99 latency >= 240s (80%)",
        "ComparisonOperator": "GreaterThanThreshold",
        "EvaluationPeriods": 3,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": "p99",
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubInventoryCanary63D899BC",
                    },
                  },
                ],
                "MetricName": "Duration",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "p99",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 240000,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubInventoryCanary54F5B7ACErrorsAlarm2DCA11C4": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 errors per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubInventoryCanary63D899BC",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubInventoryCanary54F5B7ACThrottlesAlarm0D677953": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 throttles per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubInventoryCanary63D899BC",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Throttles",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubTransliterator3B0A6087DurationAlarm0D60D33F": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "p99 latency >= 720s (80%)",
        "ComparisonOperator": "GreaterThanThreshold",
        "EvaluationPeriods": 3,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": "p99",
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubTransliterator9C48708A",
                    },
                  },
                ],
                "MetricName": "Duration",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "p99",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 720000,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubTransliterator3B0A6087ErrorsAlarm1EDE57BC": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 errors per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubTransliterator9C48708A",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubTransliterator3B0A6087ThrottlesAlarm34A8C7C1": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 throttles per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubTransliterator9C48708A",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Throttles",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWebCanaryHomePageErrorsE7BB4002": Object {
      "Properties": Object {
        "AlarmActions": Array [
          "arn:aws:sns:us-east-1:123456789012:mystack-mytopic-NZJ5JSMVGFIE",
        ],
        "AlarmDescription": Object {
          "Fn::Join": Array [
            "",
            Array [
              "80% error rate for https://",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubWebAppDistribution1F181DC9",
                  "DomainName",
                ],
              },
              " (Home Page)",
            ],
          ],
        },
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "EvaluationPeriods": 1,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": Object {
              "Fn::Join": Array [
                "",
                Array [
                  "https://",
                  Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubWebAppDistribution1F181DC9",
                      "DomainName",
                    ],
                  },
                  " Errors",
                ],
              ],
            },
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionF27ADDC8",
                    },
                  },
                ],
                "MetricName": "Errors",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "Sum",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 4,
        "TreatMissingData": "breaching",
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionF27ADDC8": Object {
      "DependsOn": Array [
        "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionServiceRole9AAAD93C",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5S3BucketFA2341B6",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5S3VersionKeyB4EE9C49",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5S3VersionKeyB4EE9C49",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Description": Object {
          "Fn::Join": Array [
            "",
            Array [
              "HTTP GET https://",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubWebAppDistribution1F181DC9",
                  "DomainName",
                ],
              },
              ": Home Page",
            ],
          ],
        },
        "Environment": Object {
          "Variables": Object {
            "URL": Object {
              "Fn::Join": Array [
                "",
                Array [
                  "https://",
                  Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubWebAppDistribution1F181DC9",
                      "DomainName",
                    ],
                  },
                ],
              ],
            },
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionServiceRole9AAAD93C",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionServiceRole9AAAD93C": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubMonitoringWebCanaryHomePageRuleAllowEventRuleTestConstructHubMonitoringWebCanaryHomePageHttpGetFunction941819C9E47F90EE": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionF27ADDC8",
            "Arn",
          ],
        },
        "Principal": "events.amazonaws.com",
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubMonitoringWebCanaryHomePageRuleE14F9F4E",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubMonitoringWebCanaryHomePageRuleE14F9F4E": Object {
      "Properties": Object {
        "ScheduleExpression": "rate(1 minute)",
        "State": "ENABLED",
        "Targets": Array [
          Object {
            "Arn": Object {
              "Fn::GetAtt": Array [
                "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionF27ADDC8",
                "Arn",
              ],
            },
            "Id": "Target0",
          },
        ],
      },
      "Type": "AWS::Events::Rule",
    },
    "ConstructHubPackageDataAllowBucketNotificationsToTestConstructHubCatalogBuilderC9A41048952FCDC8": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubCatalogBuilder5A9DE4AF",
            "Arn",
          ],
        },
        "Principal": "s3.amazonaws.com",
        "SourceAccount": Object {
          "Ref": "AWS::AccountId",
        },
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubPackageDataDC5EF35E",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubPackageDataAllowBucketNotificationsToTestConstructHubTransliterator3B0A6087EA339303": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubTransliterator9C48708A",
            "Arn",
          ],
        },
        "Principal": "s3.amazonaws.com",
        "SourceAccount": Object {
          "Ref": "AWS::AccountId",
        },
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubPackageDataDC5EF35E",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubPackageDataDC5EF35E": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "BucketEncryption": Object {
          "ServerSideEncryptionConfiguration": Array [
            Object {
              "ServerSideEncryptionByDefault": Object {
                "SSEAlgorithm": "AES256",
              },
            },
          ],
        },
        "LifecycleConfiguration": Object {
          "Rules": Array [
            Object {
              "AbortIncompleteMultipartUpload": Object {
                "DaysAfterInitiation": 1,
              },
              "Status": "Enabled",
            },
            Object {
              "NoncurrentVersionTransitions": Array [
                Object {
                  "StorageClass": "STANDARD_IA",
                  "TransitionInDays": 31,
                },
              ],
              "Status": "Enabled",
            },
            Object {
              "NoncurrentVersionExpirationInDays": 90,
              "Status": "Enabled",
            },
          ],
        },
        "PublicAccessBlockConfiguration": Object {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true,
        },
        "VersioningConfiguration": Object {
          "Status": "Enabled",
        },
      },
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
    },
    "ConstructHubPackageDataNotifications81B45141": Object {
      "DependsOn": Array [
        "ConstructHubPackageDataAllowBucketNotificationsToTestConstructHubCatalogBuilderC9A41048952FCDC8",
        "ConstructHubPackageDataAllowBucketNotificationsToTestConstructHubTransliterator3B0A6087EA339303",
      ],
      "Properties": Object {
        "BucketName": Object {
          "Ref": "ConstructHubPackageDataDC5EF35E",
        },
        "Managed": true,
        "NotificationConfiguration": Object {
          "LambdaFunctionConfigurations": Array [
            Object {
              "Events": Array [
                "s3:ObjectCreated:*",
              ],
              "Filter": Object {
                "Key": Object {
                  "FilterRules": Array [
                    Object {
                      "Name": "suffix",
                      "Value": "/package.tgz",
                    },
                    Object {
                      "Name": "prefix",
                      "Value": "data/",
                    },
                  ],
                },
              },
              "LambdaFunctionArn": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubTransliterator9C48708A",
                  "Arn",
                ],
              },
            },
            Object {
              "Events": Array [
                "s3:ObjectCreated:*",
              ],
              "Filter": Object {
                "Key": Object {
                  "FilterRules": Array [
                    Object {
                      "Name": "suffix",
                      "Value": "/assembly.json",
                    },
                    Object {
                      "Name": "prefix",
                      "Value": "data/",
                    },
                  ],
                },
              },
              "LambdaFunctionArn": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCatalogBuilder5A9DE4AF",
                  "Arn",
                ],
              },
            },
          ],
        },
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "BucketNotificationsHandler050a0587b7544547bf325f094a3db8347ECC3691",
            "Arn",
          ],
        },
      },
      "Type": "Custom::S3BucketNotifications",
    },
    "ConstructHubPackageDataPolicy4615475A": Object {
      "Properties": Object {
        "Bucket": Object {
          "Ref": "ConstructHubPackageDataDC5EF35E",
        },
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "s3:GetObject",
              "Effect": "Allow",
              "Principal": Object {
                "CanonicalUser": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubWebAppDistributionOrigin2S3OriginDA7E7FF4",
                    "S3CanonicalUserId",
                  ],
                },
              },
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    Object {
                      "Fn::GetAtt": Array [
                        "ConstructHubPackageDataDC5EF35E",
                        "Arn",
                      ],
                    },
                    "/*",
                  ],
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::S3::BucketPolicy",
    },
    "ConstructHubTransliterator9C48708A": Object {
      "DependsOn": Array [
        "ConstructHubTransliteratorServiceRoleDefaultPolicyB9C4BE06",
        "ConstructHubTransliteratorServiceRole0F8A20C8",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaS3Bucket03A867A5",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaS3VersionKeyC53D0DC5",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaS3VersionKeyC53D0DC5",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "DeadLetterConfig": Object {
          "TargetArn": Object {
            "Fn::GetAtt": Array [
              "ConstructHubTransliteratorDeadLetterQueue5544BC9A",
              "Arn",
            ],
          },
        },
        "Description": "Creates transliterated assemblies from jsii-enabled npm packages",
        "Environment": Object {
          "Variables": Object {
            "CODE_ARTIFACT_API_ENDPOINT": Object {
              "Fn::Select": Array [
                1,
                Object {
                  "Fn::Split": Array [
                    ":",
                    Object {
                      "Fn::Select": Array [
                        0,
                        Object {
                          "Fn::GetAtt": Array [
                            "ConstructHubVPCCodeArtifactAPI954CFDE1",
                            "DnsEntries",
                          ],
                        },
                      ],
                    },
                  ],
                },
              ],
            },
            "CODE_ARTIFACT_DOMAIN_NAME": Object {
              "Fn::GetAtt": Array [
                "ConstructHubCodeArtifact1188409E",
                "DomainName",
              ],
            },
            "CODE_ARTIFACT_DOMAIN_OWNER": Object {
              "Fn::GetAtt": Array [
                "ConstructHubCodeArtifact1188409E",
                "DomainOwner",
              ],
            },
            "CODE_ARTIFACT_REPOSITORY_ENDPOINT": Object {
              "Fn::GetAtt": Array [
                "ConstructHubCodeArtifactGetEndpoint9A458FEF",
                "repositoryEndpoint",
              ],
            },
          },
        },
        "Handler": "index.handler",
        "MemorySize": 10240,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubTransliteratorServiceRole0F8A20C8",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 900,
        "VpcConfig": Object {
          "SecurityGroupIds": Array [
            Object {
              "Fn::GetAtt": Array [
                "ConstructHubTransliteratorSecurityGroup575788E8",
                "GroupId",
              ],
            },
          ],
          "SubnetIds": Array [
            Object {
              "Ref": "ConstructHubVPCIsolatedSubnet1SubnetEA28FD1A",
            },
            Object {
              "Ref": "ConstructHubVPCIsolatedSubnet2Subnet483D4302",
            },
          ],
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubTransliteratorDLQAlarmA93C182B": Object {
      "Properties": Object {
        "AlarmDescription": "The transliteration function failed for one or more packages",
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "Dimensions": Array [
          Object {
            "Name": "QueueName",
            "Value": Object {
              "Fn::GetAtt": Array [
                "ConstructHubTransliteratorDeadLetterQueue5544BC9A",
                "QueueName",
              ],
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "ApproximateNumberOfMessagesVisible",
        "Namespace": "AWS/SQS",
        "Period": 300,
        "Statistic": "Maximum",
        "Threshold": 1,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubTransliteratorDeadLetterQueue5544BC9A": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "MessageRetentionPeriod": 1209600,
      },
      "Type": "AWS::SQS::Queue",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubTransliteratorEventInvokeConfig999CBA91": Object {
      "Properties": Object {
        "FunctionName": Object {
          "Ref": "ConstructHubTransliterator9C48708A",
        },
        "MaximumRetryAttempts": 2,
        "Qualifier": "$LATEST",
      },
      "Type": "AWS::Lambda::EventInvokeConfig",
    },
    "ConstructHubTransliteratorLogRetention25A9F47C": Object {
      "Properties": Object {
        "LogGroupName": Object {
          "Fn::Join": Array [
            "",
            Array [
              "/aws/lambda/",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A",
            "Arn",
          ],
        },
      },
      "Type": "Custom::LogRetention",
    },
    "ConstructHubTransliteratorSecurityGroup575788E8": Object {
      "Properties": Object {
        "GroupDescription": "Automatic security group for Lambda Function TestConstructHubTransliterator3B0A6087",
        "SecurityGroupEgress": Array [
          Object {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::SecurityGroup",
    },
    "ConstructHubTransliteratorServiceRole0F8A20C8": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubTransliteratorServiceRoleDefaultPolicyB9C4BE06": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sqs:SendMessage",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubTransliteratorDeadLetterQueue5544BC9A",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": "sts:GetServiceBearerToken",
              "Condition": Object {
                "StringEquals": Object {
                  "sts:AWSServiceName": "codeartifact.amazonaws.com",
                },
              },
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": Array [
                "codeartifact:GetAuthorizationToken",
                "codeartifact:GetRepositoryEndpoint",
                "codeartifact:ReadFromRepository",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubCodeArtifactDomainFC30B796",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubCodeArtifact1188409E",
                    "Arn",
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/data/*/package.tgz",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/data/*/assembly-*.json",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubTransliteratorServiceRoleDefaultPolicyB9C4BE06",
        "Roles": Array [
          Object {
            "Ref": "ConstructHubTransliteratorServiceRole0F8A20C8",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubVPC16ECCEA2": Object {
      "Properties": Object {
        "CidrBlock": "10.0.0.0/16",
        "EnableDnsHostnames": true,
        "EnableDnsSupport": true,
        "InstanceTenancy": "default",
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC",
          },
        ],
      },
      "Type": "AWS::EC2::VPC",
    },
    "ConstructHubVPCCodeArtifactAPI954CFDE1": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:GetServiceBearerToken",
              "Condition": Object {
                "StringEquals": Object {
                  "sts:AWSServiceName": "codeartifact.amazonaws.com",
                },
              },
              "Effect": "Allow",
              "Principal": Object {
                "AWS": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubTransliteratorServiceRole0F8A20C8",
                    "Arn",
                  ],
                },
              },
              "Resource": "*",
            },
            Object {
              "Action": Array [
                "codeartifact:GetAuthorizationToken",
                "codeartifact:GetRepositoryEndpoint",
              ],
              "Effect": "Allow",
              "Principal": Object {
                "AWS": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubTransliteratorServiceRole0F8A20C8",
                    "Arn",
                  ],
                },
              },
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubCodeArtifactDomainFC30B796",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubCodeArtifact1188409E",
                    "Arn",
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PrivateDnsEnabled": false,
        "SecurityGroupIds": Array [
          Object {
            "Fn::GetAtt": Array [
              "ConstructHubVPCCodeArtifactAPISecurityGroupBE06BEF9",
              "GroupId",
            ],
          },
        ],
        "ServiceName": Object {
          "Fn::Join": Array [
            "",
            Array [
              "com.amazonaws.",
              Object {
                "Ref": "AWS::Region",
              },
              ".codeartifact.api",
            ],
          ],
        },
        "SubnetIds": Array [
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet1SubnetEA28FD1A",
          },
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet2Subnet483D4302",
          },
        ],
        "VpcEndpointType": "Interface",
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::VPCEndpoint",
    },
    "ConstructHubVPCCodeArtifactAPISecurityGroupBE06BEF9": Object {
      "Properties": Object {
        "GroupDescription": "Test/ConstructHub/VPC/CodeArtifact.API/SecurityGroup",
        "SecurityGroupEgress": Array [
          Object {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1",
          },
        ],
        "SecurityGroupIngress": Array [
          Object {
            "CidrIp": Object {
              "Fn::GetAtt": Array [
                "ConstructHubVPC16ECCEA2",
                "CidrBlock",
              ],
            },
            "Description": Object {
              "Fn::Join": Array [
                "",
                Array [
                  "from ",
                  Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubVPC16ECCEA2",
                      "CidrBlock",
                    ],
                  },
                  ":443",
                ],
              ],
            },
            "FromPort": 443,
            "IpProtocol": "tcp",
            "ToPort": 443,
          },
        ],
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::SecurityGroup",
    },
    "ConstructHubVPCCodeArtifactBD6E076F": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "codeartifact:ReadFromRepository",
              "Effect": "Allow",
              "Principal": Object {
                "AWS": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubTransliteratorServiceRole0F8A20C8",
                    "Arn",
                  ],
                },
              },
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PrivateDnsEnabled": true,
        "SecurityGroupIds": Array [
          Object {
            "Fn::GetAtt": Array [
              "ConstructHubVPCCodeArtifactSecurityGroupBCADE40D",
              "GroupId",
            ],
          },
        ],
        "ServiceName": Object {
          "Fn::Join": Array [
            "",
            Array [
              "com.amazonaws.",
              Object {
                "Ref": "AWS::Region",
              },
              ".codeartifact.repositories",
            ],
          ],
        },
        "SubnetIds": Array [
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet1SubnetEA28FD1A",
          },
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet2Subnet483D4302",
          },
        ],
        "VpcEndpointType": "Interface",
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::VPCEndpoint",
    },
    "ConstructHubVPCCodeArtifactSecurityGroupBCADE40D": Object {
      "Properties": Object {
        "GroupDescription": "Test/ConstructHub/VPC/CodeArtifact/SecurityGroup",
        "SecurityGroupEgress": Array [
          Object {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1",
          },
        ],
        "SecurityGroupIngress": Array [
          Object {
            "CidrIp": Object {
              "Fn::GetAtt": Array [
                "ConstructHubVPC16ECCEA2",
                "CidrBlock",
              ],
            },
            "Description": Object {
              "Fn::Join": Array [
                "",
                Array [
                  "from ",
                  Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubVPC16ECCEA2",
                      "CidrBlock",
                    ],
                  },
                  ":443",
                ],
              ],
            },
            "FromPort": 443,
            "IpProtocol": "tcp",
            "ToPort": 443,
          },
        ],
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::SecurityGroup",
    },
    "ConstructHubVPCIsolatedSubnet1RouteTable750E6F36": Object {
      "Properties": Object {
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC/IsolatedSubnet1",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::RouteTable",
    },
    "ConstructHubVPCIsolatedSubnet1RouteTableAssociation3F8E4C37": Object {
      "Properties": Object {
        "RouteTableId": Object {
          "Ref": "ConstructHubVPCIsolatedSubnet1RouteTable750E6F36",
        },
        "SubnetId": Object {
          "Ref": "ConstructHubVPCIsolatedSubnet1SubnetEA28FD1A",
        },
      },
      "Type": "AWS::EC2::SubnetRouteTableAssociation",
    },
    "ConstructHubVPCIsolatedSubnet1SubnetEA28FD1A": Object {
      "Properties": Object {
        "AvailabilityZone": Object {
          "Fn::Select": Array [
            0,
            Object {
              "Fn::GetAZs": "",
            },
          ],
        },
        "CidrBlock": "10.0.0.0/17",
        "MapPublicIpOnLaunch": false,
        "Tags": Array [
          Object {
            "Key": "aws-cdk:subnet-name",
            "Value": "Isolated",
          },
          Object {
            "Key": "aws-cdk:subnet-type",
            "Value": "Isolated",
          },
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC/IsolatedSubnet1",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::Subnet",
    },
    "ConstructHubVPCIsolatedSubnet2RouteTable18129C5D": Object {
      "Properties": Object {
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC/IsolatedSubnet2",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::RouteTable",
    },
    "ConstructHubVPCIsolatedSubnet2RouteTableAssociationF8AD0E0F": Object {
      "Properties": Object {
        "RouteTableId": Object {
          "Ref": "ConstructHubVPCIsolatedSubnet2RouteTable18129C5D",
        },
        "SubnetId": Object {
          "Ref": "ConstructHubVPCIsolatedSubnet2Subnet483D4302",
        },
      },
      "Type": "AWS::EC2::SubnetRouteTableAssociation",
    },
    "ConstructHubVPCIsolatedSubnet2Subnet483D4302": Object {
      "Properties": Object {
        "AvailabilityZone": Object {
          "Fn::Select": Array [
            1,
            Object {
              "Fn::GetAZs": "",
            },
          ],
        },
        "CidrBlock": "10.0.128.0/17",
        "MapPublicIpOnLaunch": false,
        "Tags": Array [
          Object {
            "Key": "aws-cdk:subnet-name",
            "Value": "Isolated",
          },
          Object {
            "Key": "aws-cdk:subnet-type",
            "Value": "Isolated",
          },
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC/IsolatedSubnet2",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::Subnet",
    },
    "ConstructHubVPCS319E90CB6": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "s3:GetObject",
              "Effect": "Allow",
              "Principal": "*",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    Object {
                      "Fn::GetAtt": Array [
                        "ConstructHubCodeArtifactDescribeDomain6ABCBF4B",
                        "domain.s3BucketArn",
                      ],
                    },
                    "/*",
                  ],
                ],
              },
              "Sid": "Allow-CodeArtifact-Bucket",
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Principal": "*",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/data/*/package.tgz",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "s3:Abort*",
                "s3:DeleteObject*",
                "s3:PutObject*",
              ],
              "Effect": "Allow",
              "Principal": "*",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/data/*/assembly-*.json",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "RouteTableIds": Array [
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet1RouteTable750E6F36",
          },
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet2RouteTable18129C5D",
          },
        ],
        "ServiceName": Object {
          "Fn::Join": Array [
            "",
            Array [
              "com.amazonaws.",
              Object {
                "Ref": "AWS::Region",
              },
              ".s3",
            ],
          ],
        },
        "VpcEndpointType": "Gateway",
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::VPCEndpoint",
    },
    "ConstructHubWebAppDeployWebsiteAwsCliLayer23CFFBC1": Object {
      "Properties": Object {
        "Content": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68S3BucketAEADE8C7",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68S3VersionKeyE415415F",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68S3VersionKeyE415415F",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Description": "/opt/awscli/aws",
      },
      "Type": "AWS::Lambda::LayerVersion",
    },
    "ConstructHubWebAppDeployWebsiteCustomResourceE6DF98C9": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "DestinationBucketName": Object {
          "Ref": "ConstructHubWebAppWebsiteBucket4B2B9DB2",
        },
        "DistributionId": Object {
          "Ref": "ConstructHubWebAppDistribution1F181DC9",
        },
        "Prune": true,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536",
            "Arn",
          ],
        },
        "SourceBucketNames": Array [
          Object {
            "Ref": "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3Bucket7E2DA7AC",
          },
        ],
        "SourceObjectKeys": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3VersionKeyDEDF4AE1",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3VersionKeyDEDF4AE1",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        ],
      },
      "Type": "Custom::CDKBucketDeployment",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubWebAppDistribution1F181DC9": Object {
      "Properties": Object {
        "DistributionConfig": Object {
          "CacheBehaviors": Array [
            Object {
              "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
              "Compress": true,
              "FunctionAssociations": Array [
                Object {
                  "EventType": "viewer-response",
                  "FunctionARN": Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubWebAppResponseFunction4C2BF3E9",
                      "FunctionARN",
                    ],
                  },
                },
              ],
              "PathPattern": "/data/*",
              "TargetOriginId": "TestConstructHubWebAppDistributionOrigin276090F90",
              "ViewerProtocolPolicy": "allow-all",
            },
            Object {
              "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
              "Compress": true,
              "FunctionAssociations": Array [
                Object {
                  "EventType": "viewer-response",
                  "FunctionARN": Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubWebAppResponseFunction4C2BF3E9",
                      "FunctionARN",
                    ],
                  },
                },
              ],
              "PathPattern": "/catalog.json",
              "TargetOriginId": "TestConstructHubWebAppDistributionOrigin276090F90",
              "ViewerProtocolPolicy": "allow-all",
            },
          ],
          "CustomErrorResponses": Array [
            Object {
              "ErrorCode": 404,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html",
            },
            Object {
              "ErrorCode": 403,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html",
            },
          ],
          "DefaultCacheBehavior": Object {
            "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
            "Compress": true,
            "FunctionAssociations": Array [
              Object {
                "EventType": "viewer-response",
                "FunctionARN": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubWebAppResponseFunction4C2BF3E9",
                    "FunctionARN",
                  ],
                },
              },
            ],
            "TargetOriginId": "TestConstructHubWebAppDistributionOrigin171FF58D3",
            "ViewerProtocolPolicy": "allow-all",
          },
          "DefaultRootObject": "index.html",
          "Enabled": true,
          "HttpVersion": "http2",
          "IPV6Enabled": true,
          "Origins": Array [
            Object {
              "DomainName": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubWebAppWebsiteBucket4B2B9DB2",
                  "RegionalDomainName",
                ],
              },
              "Id": "TestConstructHubWebAppDistributionOrigin171FF58D3",
              "S3OriginConfig": Object {
                "OriginAccessIdentity": Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "origin-access-identity/cloudfront/",
                      Object {
                        "Ref": "ConstructHubWebAppDistributionOrigin1S3Origin694AF937",
                      },
                    ],
                  ],
                },
              },
            },
            Object {
              "DomainName": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubPackageDataDC5EF35E",
                  "RegionalDomainName",
                ],
              },
              "Id": "TestConstructHubWebAppDistributionOrigin276090F90",
              "S3OriginConfig": Object {
                "OriginAccessIdentity": Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "origin-access-identity/cloudfront/",
                      Object {
                        "Ref": "ConstructHubWebAppDistributionOrigin2S3OriginDA7E7FF4",
                      },
                    ],
                  ],
                },
              },
            },
          ],
        },
      },
      "Type": "AWS::CloudFront::Distribution",
    },
    "ConstructHubWebAppDistributionOrigin1S3Origin694AF937": Object {
      "Properties": Object {
        "CloudFrontOriginAccessIdentityConfig": Object {
          "Comment": "Identity for TestConstructHubWebAppDistributionOrigin171FF58D3",
        },
      },
      "Type": "AWS::CloudFront::CloudFrontOriginAccessIdentity",
    },
    "ConstructHubWebAppDistributionOrigin2S3OriginDA7E7FF4": Object {
      "Properties": Object {
        "CloudFrontOriginAccessIdentityConfig": Object {
          "Comment": "Identity for TestConstructHubWebAppDistributionOrigin276090F90",
        },
      },
      "Type": "AWS::CloudFront::CloudFrontOriginAccessIdentity",
    },
    "ConstructHubWebAppResponseFunction4C2BF3E9": Object {
      "Properties": Object {
        "AutoPublish": true,
        "FunctionCode": "\\"use strict\\";
function handler(event) {
    var response = event.response;
    var headers = response.headers;
    headers['x-frame-options'] = { value: 'deny' };
    headers['x-xss-protection'] = { value: '1; mode=block' };
    headers['x-content-type-options'] = { value: 'nosniff' };
    headers['strict-transport-security'] = { value: 'max-age=47304000; includeSubDomains' };
    headers['content-security-policy'] = {
        value: 'default-src \\\\'none\\\\'; img-src \\\\'self\\\\' https://img.shields.io; script-src \\\\'self\\\\'; style-src \\\\'unsafe-inline\\\\' \\\\'self\\\\'; object-src \\\\'none\\\\'; connect-src \\\\'self\\\\'; manifest-src \\\\'self\\\\'; font-src \\\\'self\\\\'; frame-src \\\\'none\\\\'',
    };
    return response;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzcG9uc2UtZnVuY3Rpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvd2ViYXBwL3Jlc3BvbnNlLWZ1bmN0aW9uL3Jlc3BvbnNlLWZ1bmN0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFTQSxTQUFTLE9BQU8sQ0FBQyxLQUF5QjtJQUN4QyxJQUFJLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDO0lBQzlCLElBQUksT0FBTyxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUM7SUFFL0IsT0FBTyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLENBQUM7SUFDL0MsT0FBTyxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsZUFBZSxFQUFFLENBQUM7SUFDekQsT0FBTyxDQUFDLHdCQUF3QixDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLENBQUM7SUFDekQsT0FBTyxDQUFDLDJCQUEyQixDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUscUNBQXFDLEVBQUUsQ0FBQztJQUN4RixPQUFPLENBQUMseUJBQXlCLENBQUMsR0FBRztRQUNuQyxLQUFLLEVBQ0gsbU9BQW1PO0tBQ3RPLENBQUM7SUFFRixPQUFPLFFBQVEsQ0FBQztBQUNsQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW50ZXJmYWNlIENsb3VkRnJvbnRSZXNwb25zZSB7XG4gIHJlc3BvbnNlOiBhbnk7XG4gIGhlYWRlcnM6IHtcbiAgICBba2V5OiBzdHJpbmddOiB7XG4gICAgICB2YWx1ZTogc3RyaW5nO1xuICAgIH07XG4gIH07XG59XG5cbmZ1bmN0aW9uIGhhbmRsZXIoZXZlbnQ6IENsb3VkRnJvbnRSZXNwb25zZSkge1xuICB2YXIgcmVzcG9uc2UgPSBldmVudC5yZXNwb25zZTtcbiAgdmFyIGhlYWRlcnMgPSByZXNwb25zZS5oZWFkZXJzO1xuXG4gIGhlYWRlcnNbJ3gtZnJhbWUtb3B0aW9ucyddID0geyB2YWx1ZTogJ2RlbnknIH07XG4gIGhlYWRlcnNbJ3gteHNzLXByb3RlY3Rpb24nXSA9IHsgdmFsdWU6ICcxOyBtb2RlPWJsb2NrJyB9O1xuICBoZWFkZXJzWyd4LWNvbnRlbnQtdHlwZS1vcHRpb25zJ10gPSB7IHZhbHVlOiAnbm9zbmlmZicgfTtcbiAgaGVhZGVyc1snc3RyaWN0LXRyYW5zcG9ydC1zZWN1cml0eSddID0geyB2YWx1ZTogJ21heC1hZ2U9NDczMDQwMDA7IGluY2x1ZGVTdWJEb21haW5zJyB9O1xuICBoZWFkZXJzWydjb250ZW50LXNlY3VyaXR5LXBvbGljeSddID0ge1xuICAgIHZhbHVlOlxuICAgICAgJ2RlZmF1bHQtc3JjIFxcJ25vbmVcXCc7IGltZy1zcmMgXFwnc2VsZlxcJyBodHRwczovL2ltZy5zaGllbGRzLmlvOyBzY3JpcHQtc3JjIFxcJ3NlbGZcXCc7IHN0eWxlLXNyYyBcXCd1bnNhZmUtaW5saW5lXFwnIFxcJ3NlbGZcXCc7IG9iamVjdC1zcmMgXFwnbm9uZVxcJzsgY29ubmVjdC1zcmMgXFwnc2VsZlxcJzsgbWFuaWZlc3Qtc3JjIFxcJ3NlbGZcXCc7IGZvbnQtc3JjIFxcJ3NlbGZcXCc7IGZyYW1lLXNyYyBcXCdub25lXFwnJyxcbiAgfTtcblxuICByZXR1cm4gcmVzcG9uc2U7XG59XG4iXX0=",
        "FunctionConfig": Object {
          "Comment": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Ref": "AWS::Region",
                },
                "TestConstrubWebAppResponseFunction1F387BCC",
              ],
            ],
          },
          "Runtime": "cloudfront-js-1.0",
        },
        "Name": Object {
          "Fn::Join": Array [
            "",
            Array [
              Object {
                "Ref": "AWS::Region",
              },
              "TestConstrubWebAppResponseFunction1F387BCC",
            ],
          ],
        },
      },
      "Type": "AWS::CloudFront::Function",
    },
    "ConstructHubWebAppWebsiteBucket4B2B9DB2": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "PublicAccessBlockConfiguration": Object {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true,
        },
      },
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
    },
    "ConstructHubWebAppWebsiteBucketPolicy17174C06": Object {
      "Properties": Object {
        "Bucket": Object {
          "Ref": "ConstructHubWebAppWebsiteBucket4B2B9DB2",
        },
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "s3:GetObject",
              "Effect": "Allow",
              "Principal": Object {
                "CanonicalUser": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubWebAppDistributionOrigin1S3Origin694AF937",
                    "S3CanonicalUserId",
                  ],
                },
              },
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    Object {
                      "Fn::GetAtt": Array [
                        "ConstructHubWebAppWebsiteBucket4B2B9DB2",
                        "Arn",
                      ],
                    },
                    "/*",
                  ],
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::S3::BucketPolicy",
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536": Object {
      "DependsOn": Array [
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfS3Bucket55EFA30C",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfS3VersionKey60329B70",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfS3VersionKey60329B70",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Handler": "index.handler",
        "Layers": Array [
          Object {
            "Ref": "ConstructHubWebAppDeployWebsiteAwsCliLayer23CFFBC1",
          },
        ],
        "Role": Object {
          "Fn::GetAtt": Array [
            "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
            "Arn",
          ],
        },
        "Runtime": "python3.6",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":s3:::",
                      Object {
                        "Ref": "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3Bucket7E2DA7AC",
                      },
                    ],
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":s3:::",
                      Object {
                        "Ref": "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3Bucket7E2DA7AC",
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubWebAppWebsiteBucket4B2B9DB2",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubWebAppWebsiteBucket4B2B9DB2",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "cloudfront:GetInvalidation",
                "cloudfront:CreateInvalidation",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
        "Roles": Array [
          Object {
            "Ref": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A": Object {
      "DependsOn": Array [
        "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB",
        "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3Bucket4D46ABB5",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3VersionKeyB0F28861",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3VersionKeyB0F28861",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
      },
      "Type": "AWS::Lambda::Function",
    },
    "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "logs:PutRetentionPolicy",
                "logs:DeleteRetentionPolicy",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB",
        "Roles": Array [
          Object {
            "Ref": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
  },
}
`;

exports[`with domain 1`] = `
Object {
  "Mappings": Object {
    "AWSCloudFrontPartitionHostedZoneIdMap": Object {
      "aws": Object {
        "zoneId": "Z2FDTNDATAQYW2",
      },
      "aws-cn": Object {
        "zoneId": "Z3RFFRIM2A3IF5",
      },
    },
  },
  "Outputs": Object {
    "ConstructHubMonitoringWatchfulWatchfulDashboard75D318D0": Object {
      "Value": Object {
        "Fn::Join": Array [
          "",
          Array [
            "https://console.aws.amazon.com/cloudwatch/home?region=",
            Object {
              "Ref": "AWS::Region",
            },
            "#dashboards:name=",
            Object {
              "Ref": "ConstructHubMonitoringWatchfulDashboardB8493D55",
            },
          ],
        ],
      },
    },
    "ConstructHubWebAppDomainNameDC10F8DD": Object {
      "Export": Object {
        "Name": "ConstructHubDomainName",
      },
      "Value": Object {
        "Fn::GetAtt": Array [
          "ConstructHubWebAppDistribution1F181DC9",
          "DomainName",
        ],
      },
    },
  },
  "Parameters": Object {
    "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dArtifactHashFECDD477": Object {
      "Description": "Artifact hash for asset \\"0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963d\\"",
      "Type": "String",
    },
    "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dS3Bucket7B3413EA": Object {
      "Description": "S3 bucket for asset \\"0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963d\\"",
      "Type": "String",
    },
    "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dS3VersionKeyE2914469": Object {
      "Description": "S3 key for asset version \\"0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963d\\"",
      "Type": "String",
    },
    "AssetParameters1ba28ce93db643201d8613eed4b49e8bfdbb812137021b400028887aa6cbfc21ArtifactHashCD81A433": Object {
      "Description": "Artifact hash for asset \\"1ba28ce93db643201d8613eed4b49e8bfdbb812137021b400028887aa6cbfc21\\"",
      "Type": "String",
    },
    "AssetParameters1ba28ce93db643201d8613eed4b49e8bfdbb812137021b400028887aa6cbfc21S3Bucket06D21812": Object {
      "Description": "S3 bucket for asset \\"1ba28ce93db643201d8613eed4b49e8bfdbb812137021b400028887aa6cbfc21\\"",
      "Type": "String",
    },
    "AssetParameters1ba28ce93db643201d8613eed4b49e8bfdbb812137021b400028887aa6cbfc21S3VersionKey1BCE3833": Object {
      "Description": "S3 key for asset version \\"1ba28ce93db643201d8613eed4b49e8bfdbb812137021b400028887aa6cbfc21\\"",
      "Type": "String",
    },
    "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bArtifactHashD350A16C": Object {
      "Description": "Artifact hash for asset \\"29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780b\\"",
      "Type": "String",
    },
    "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bS3Bucket3171CA99": Object {
      "Description": "S3 bucket for asset \\"29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780b\\"",
      "Type": "String",
    },
    "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bS3VersionKeyB69597A2": Object {
      "Description": "S3 key for asset version \\"29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780b\\"",
      "Type": "String",
    },
    "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236ArtifactHashE5BF8317": Object {
      "Description": "Artifact hash for asset \\"3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236\\"",
      "Type": "String",
    },
    "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236S3BucketD05214B3": Object {
      "Description": "S3 bucket for asset \\"3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236\\"",
      "Type": "String",
    },
    "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236S3VersionKey29F1A337": Object {
      "Description": "S3 key for asset version \\"3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236\\"",
      "Type": "String",
    },
    "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5ArtifactHash76FE5C86": Object {
      "Description": "Artifact hash for asset \\"59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5\\"",
      "Type": "String",
    },
    "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5S3BucketFA2341B6": Object {
      "Description": "S3 bucket for asset \\"59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5\\"",
      "Type": "String",
    },
    "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5S3VersionKeyB4EE9C49": Object {
      "Description": "S3 key for asset version \\"59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5\\"",
      "Type": "String",
    },
    "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24ArtifactHashBA91B77F": Object {
      "Description": "Artifact hash for asset \\"67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24\\"",
      "Type": "String",
    },
    "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3Bucket4D46ABB5": Object {
      "Description": "S3 bucket for asset \\"67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24\\"",
      "Type": "String",
    },
    "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3VersionKeyB0F28861": Object {
      "Description": "S3 key for asset version \\"67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24\\"",
      "Type": "String",
    },
    "AssetParameters7af6295e521fd55af94332393ceffb3e866aac4dc4956321f7918f21e72199e4ArtifactHash5E28809B": Object {
      "Description": "Artifact hash for asset \\"7af6295e521fd55af94332393ceffb3e866aac4dc4956321f7918f21e72199e4\\"",
      "Type": "String",
    },
    "AssetParameters7af6295e521fd55af94332393ceffb3e866aac4dc4956321f7918f21e72199e4S3Bucket5BEBDCBE": Object {
      "Description": "S3 bucket for asset \\"7af6295e521fd55af94332393ceffb3e866aac4dc4956321f7918f21e72199e4\\"",
      "Type": "String",
    },
    "AssetParameters7af6295e521fd55af94332393ceffb3e866aac4dc4956321f7918f21e72199e4S3VersionKey326451BC": Object {
      "Description": "S3 key for asset version \\"7af6295e521fd55af94332393ceffb3e866aac4dc4956321f7918f21e72199e4\\"",
      "Type": "String",
    },
    "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784ArtifactHash1A2C2611": Object {
      "Description": "Artifact hash for asset \\"97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784\\"",
      "Type": "String",
    },
    "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784S3BucketE5876F15": Object {
      "Description": "S3 bucket for asset \\"97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784\\"",
      "Type": "String",
    },
    "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784S3VersionKey267A8045": Object {
      "Description": "S3 key for asset version \\"97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784\\"",
      "Type": "String",
    },
    "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91ArtifactHash2FEFFD84": Object {
      "Description": "Artifact hash for asset \\"b175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91\\"",
      "Type": "String",
    },
    "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3Bucket7E2DA7AC": Object {
      "Description": "S3 bucket for asset \\"b175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91\\"",
      "Type": "String",
    },
    "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3VersionKeyDEDF4AE1": Object {
      "Description": "S3 key for asset version \\"b175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91\\"",
      "Type": "String",
    },
    "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaArtifactHashE807E7D1": Object {
      "Description": "Artifact hash for asset \\"ba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892ea\\"",
      "Type": "String",
    },
    "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaS3Bucket03A867A5": Object {
      "Description": "S3 bucket for asset \\"ba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892ea\\"",
      "Type": "String",
    },
    "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaS3VersionKeyC53D0DC5": Object {
      "Description": "S3 key for asset version \\"ba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892ea\\"",
      "Type": "String",
    },
    "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfArtifactHash85F58E48": Object {
      "Description": "Artifact hash for asset \\"c24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cf\\"",
      "Type": "String",
    },
    "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfS3Bucket55EFA30C": Object {
      "Description": "S3 bucket for asset \\"c24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cf\\"",
      "Type": "String",
    },
    "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfS3VersionKey60329B70": Object {
      "Description": "S3 key for asset version \\"c24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cf\\"",
      "Type": "String",
    },
    "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68ArtifactHashD9A515C3": Object {
      "Description": "Artifact hash for asset \\"e9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68\\"",
      "Type": "String",
    },
    "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68S3BucketAEADE8C7": Object {
      "Description": "S3 bucket for asset \\"e9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68\\"",
      "Type": "String",
    },
    "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68S3VersionKeyE415415F": Object {
      "Description": "S3 key for asset version \\"e9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68\\"",
      "Type": "String",
    },
    "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797ArtifactHashAAFCA968": Object {
      "Description": "Artifact hash for asset \\"f3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797\\"",
      "Type": "String",
    },
    "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797S3BucketBEE108A9": Object {
      "Description": "S3 bucket for asset \\"f3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797\\"",
      "Type": "String",
    },
    "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797S3VersionKeyA877E3C9": Object {
      "Description": "S3 key for asset version \\"f3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797\\"",
      "Type": "String",
    },
  },
  "Resources": Object {
    "AWS679f53fac002430cb0da5b7982bd22872D164C4C": Object {
      "DependsOn": Array [
        "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797S3BucketBEE108A9",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797S3VersionKeyA877E3C9",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersf3d3a3cc7f26921b237eff24fc5dd7aef8f0465a1f376b8f7918eb3d4b3e8797S3VersionKeyA877E3C9",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
            "Arn",
          ],
        },
        "Runtime": "nodejs12.x",
        "Timeout": 120,
      },
      "Type": "AWS::Lambda::Function",
    },
    "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db8347ECC3691": Object {
      "DependsOn": Array [
        "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36",
        "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC",
      ],
      "Properties": Object {
        "Code": Object {
          "ZipFile": "import boto3  # type: ignore
import json
import logging
import urllib.request

s3 = boto3.client(\\"s3\\")

CONFIGURATION_TYPES = [\\"TopicConfigurations\\", \\"QueueConfigurations\\", \\"LambdaFunctionConfigurations\\"]

def handler(event: dict, context):
    response_status = \\"SUCCESS\\"
    error_message = \\"\\"
    try:
        props = event[\\"ResourceProperties\\"]
        bucket = props[\\"BucketName\\"]
        notification_configuration = props[\\"NotificationConfiguration\\"]
        request_type = event[\\"RequestType\\"]
        managed = props.get('Managed', 'true').lower() == 'true'
        stack_id = event['StackId']

        if managed:
          config = handle_managed(request_type, notification_configuration)
        else:
          config = handle_unmanaged(bucket, stack_id, request_type, notification_configuration)

        put_bucket_notification_configuration(bucket, config)
    except Exception as e:
        logging.exception(\\"Failed to put bucket notification configuration\\")
        response_status = \\"FAILED\\"
        error_message = f\\"Error: {str(e)}. \\"
    finally:
        submit_response(event, context, response_status, error_message)


def handle_managed(request_type, notification_configuration):
  if request_type == 'Delete':
    return {}
  return notification_configuration


def handle_unmanaged(bucket, stack_id, request_type, notification_configuration):

  # find external notifications
  external_notifications = find_external_notifications(bucket, stack_id)

  # if delete, that's all we need
  if request_type == 'Delete':
    return external_notifications

  def with_id(notification):
    notification['Id'] = f\\"{stack_id}-{hash(json.dumps(notification, sort_keys=True))}\\"
    return notification

  # otherwise, merge external with incoming config and augment with id
  notifications = {}
  for t in CONFIGURATION_TYPES:
    external = external_notifications.get(t, [])
    incoming = [with_id(n) for n in notification_configuration.get(t, [])]
    notifications[t] = external + incoming
  return notifications


def find_external_notifications(bucket, stack_id):
  existing_notifications = get_bucket_notification_configuration(bucket)
  external_notifications = {}
  for t in CONFIGURATION_TYPES:
    # if the notification was created by us, we know what id to expect
    # so we can filter by it.
    external_notifications[t] = [n for n in existing_notifications.get(t, []) if not n['Id'].startswith(f\\"{stack_id}-\\")]

  return external_notifications


def get_bucket_notification_configuration(bucket):
  return s3.get_bucket_notification_configuration(Bucket=bucket)


def put_bucket_notification_configuration(bucket, notification_configuration):
  s3.put_bucket_notification_configuration(Bucket=bucket, NotificationConfiguration=notification_configuration)


def submit_response(event: dict, context, response_status: str, error_message: str):
    response_body = json.dumps(
        {
            \\"Status\\": response_status,
            \\"Reason\\": f\\"{error_message}See the details in CloudWatch Log Stream: {context.log_stream_name}\\",
            \\"PhysicalResourceId\\": event.get(\\"PhysicalResourceId\\") or event[\\"LogicalResourceId\\"],
            \\"StackId\\": event[\\"StackId\\"],
            \\"RequestId\\": event[\\"RequestId\\"],
            \\"LogicalResourceId\\": event[\\"LogicalResourceId\\"],
            \\"NoEcho\\": False,
        }
    ).encode(\\"utf-8\\")
    headers = {\\"content-type\\": \\"\\", \\"content-length\\": str(len(response_body))}
    try:
        req = urllib.request.Request(url=event[\\"ResponseURL\\"], headers=headers, data=response_body, method=\\"PUT\\")
        with urllib.request.urlopen(req) as response:
            print(response.read().decode(\\"utf-8\\"))
        print(\\"Status code: \\" + response.reason)
    except Exception as e:
        print(\\"send(..) failed executing request.urlopen(..): \\" + str(e))
",
        },
        "Description": "AWS CloudFormation handler for \\"Custom::S3BucketNotifications\\" resources (@aws-cdk/aws-s3)",
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC",
            "Arn",
          ],
        },
        "Runtime": "python3.8",
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "s3:PutBucketNotification",
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36",
        "Roles": Array [
          Object {
            "Ref": "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "CertCertificateRequestorFunction98FDF273": Object {
      "DependsOn": Array [
        "CertCertificateRequestorFunctionServiceRoleDefaultPolicy4F1E63AC",
        "CertCertificateRequestorFunctionServiceRoleF65859C0",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters7af6295e521fd55af94332393ceffb3e866aac4dc4956321f7918f21e72199e4S3Bucket5BEBDCBE",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters7af6295e521fd55af94332393ceffb3e866aac4dc4956321f7918f21e72199e4S3VersionKey326451BC",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters7af6295e521fd55af94332393ceffb3e866aac4dc4956321f7918f21e72199e4S3VersionKey326451BC",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Handler": "index.certificateRequestHandler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "CertCertificateRequestorFunctionServiceRoleF65859C0",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CertCertificateRequestorFunctionServiceRoleDefaultPolicy4F1E63AC": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "acm:RequestCertificate",
                "acm:DescribeCertificate",
                "acm:DeleteCertificate",
                "acm:AddTagsToCertificate",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "route53:GetChange",
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "route53:changeResourceRecordSets",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":route53:::hostedzone/ZONEID",
                  ],
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "CertCertificateRequestorFunctionServiceRoleDefaultPolicy4F1E63AC",
        "Roles": Array [
          Object {
            "Ref": "CertCertificateRequestorFunctionServiceRoleF65859C0",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "CertCertificateRequestorFunctionServiceRoleF65859C0": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CertCertificateRequestorResource9D0836FD": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "DomainName": "my.construct.hub",
        "HostedZoneId": "ZONEID",
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "CertCertificateRequestorFunction98FDF273",
            "Arn",
          ],
        },
      },
      "Type": "AWS::CloudFormation::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubCatalogBuilder5A9DE4AF": Object {
      "DependsOn": Array [
        "ConstructHubCatalogBuilderServiceRoleDefaultPolicyF51442BC",
        "ConstructHubCatalogBuilderServiceRole7EB4C395",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bS3Bucket3171CA99",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bS3VersionKeyB69597A2",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters29569ad5bf9948e4744218e7f7440b327629220ab1ca1cce582477911c74780bS3VersionKeyB69597A2",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "DeadLetterConfig": Object {
          "TargetArn": Object {
            "Fn::GetAtt": Array [
              "ConstructHubCatalogBuilderDeadLetterQueue1D42C407",
              "Arn",
            ],
          },
        },
        "Description": Object {
          "Fn::Join": Array [
            "",
            Array [
              "Creates the catalog.json object in ",
              Object {
                "Ref": "ConstructHubPackageDataDC5EF35E",
              },
            ],
          ],
        },
        "Environment": Object {
          "Variables": Object {
            "BUCKET_NAME": Object {
              "Ref": "ConstructHubPackageDataDC5EF35E",
            },
          },
        },
        "Handler": "index.handler",
        "MemorySize": 10240,
        "ReservedConcurrentExecutions": 1,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubCatalogBuilderServiceRole7EB4C395",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubCatalogBuilderDLQAlarm9D928A2B": Object {
      "Properties": Object {
        "AlarmDescription": "The catalog builder function failed to run",
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "Dimensions": Array [
          Object {
            "Name": "QueueName",
            "Value": Object {
              "Fn::GetAtt": Array [
                "ConstructHubCatalogBuilderDeadLetterQueue1D42C407",
                "QueueName",
              ],
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "ApproximateNumberOfMessagesVisible",
        "Namespace": "AWS/SQS",
        "Period": 300,
        "Statistic": "Maximum",
        "Threshold": 1,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubCatalogBuilderDeadLetterQueue1D42C407": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "MessageRetentionPeriod": 1209600,
      },
      "Type": "AWS::SQS::Queue",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubCatalogBuilderLogRetentionD5D7858F": Object {
      "Properties": Object {
        "LogGroupName": Object {
          "Fn::Join": Array [
            "",
            Array [
              "/aws/lambda/",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A",
            "Arn",
          ],
        },
      },
      "Type": "Custom::LogRetention",
    },
    "ConstructHubCatalogBuilderServiceRole7EB4C395": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubCatalogBuilderServiceRoleDefaultPolicyF51442BC": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sqs:SendMessage",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCatalogBuilderDeadLetterQueue1D42C407",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubCatalogBuilderServiceRoleDefaultPolicyF51442BC",
        "Roles": Array [
          Object {
            "Ref": "ConstructHubCatalogBuilderServiceRole7EB4C395",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubCodeArtifact1188409E": Object {
      "Properties": Object {
        "Description": "Proxy to npmjs.com for ConstructHub",
        "DomainName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubCodeArtifactDomainFC30B796",
            "Name",
          ],
        },
        "ExternalConnections": Array [
          "public:npmjs",
        ],
        "RepositoryName": "c857fcb69e05ffe74ccbcc624c4f6a4017daeb8cbb",
      },
      "Type": "AWS::CodeArtifact::Repository",
    },
    "ConstructHubCodeArtifactDescribeDomain6ABCBF4B": Object {
      "DeletionPolicy": "Delete",
      "DependsOn": Array [
        "ConstructHubCodeArtifactDescribeDomainCustomResourcePolicy1A93C60C",
      ],
      "Properties": Object {
        "Create": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"service\\":\\"CodeArtifact\\",\\"action\\":\\"describeDomain\\",\\"parameters\\":{\\"domain\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifactDomainFC30B796",
                  "Name",
                ],
              },
              "\\",\\"domainOwner\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifactDomainFC30B796",
                  "Owner",
                ],
              },
              "\\"},\\"physicalResourceId\\":{\\"responsePath\\":\\"domain.s3BucketArn\\"}}",
            ],
          ],
        },
        "InstallLatestAwsSdk": true,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "AWS679f53fac002430cb0da5b7982bd22872D164C4C",
            "Arn",
          ],
        },
      },
      "Type": "Custom::AWS",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubCodeArtifactDescribeDomainCustomResourcePolicy1A93C60C": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "codeartifact:DescribeDomain",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifactDomainFC30B796",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubCodeArtifactDescribeDomainCustomResourcePolicy1A93C60C",
        "Roles": Array [
          Object {
            "Ref": "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubCodeArtifactDomainFC30B796": Object {
      "Properties": Object {
        "DomainName": "c857fcb69e05ffe74ccbcc624c4f6a4017daeb8cbb",
      },
      "Type": "AWS::CodeArtifact::Domain",
    },
    "ConstructHubCodeArtifactGetEndpoint9A458FEF": Object {
      "DeletionPolicy": "Delete",
      "DependsOn": Array [
        "ConstructHubCodeArtifactGetEndpointCustomResourcePolicy4FC951E9",
      ],
      "Properties": Object {
        "Create": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"service\\":\\"CodeArtifact\\",\\"action\\":\\"getRepositoryEndpoint\\",\\"parameters\\":{\\"domain\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "DomainName",
                ],
              },
              "\\",\\"domainOwner\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "DomainOwner",
                ],
              },
              "\\",\\"format\\":\\"npm\\",\\"repository\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "Name",
                ],
              },
              "\\"},\\"physicalResourceId\\":{\\"responsePath\\":\\"repositoryEndpoint\\"}}",
            ],
          ],
        },
        "InstallLatestAwsSdk": true,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "AWS679f53fac002430cb0da5b7982bd22872D164C4C",
            "Arn",
          ],
        },
        "Update": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"service\\":\\"CodeArtifact\\",\\"action\\":\\"getRepositoryEndpoint\\",\\"parameters\\":{\\"domain\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "DomainName",
                ],
              },
              "\\",\\"domainOwner\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "DomainOwner",
                ],
              },
              "\\",\\"format\\":\\"npm\\",\\"repository\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "Name",
                ],
              },
              "\\"},\\"physicalResourceId\\":{\\"responsePath\\":\\"repositoryEndpoint\\"}}",
            ],
          ],
        },
      },
      "Type": "Custom::AWS",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubCodeArtifactGetEndpointCustomResourcePolicy4FC951E9": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "codeartifact:GetRepositoryEndpoint",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubCodeArtifactGetEndpointCustomResourcePolicy4FC951E9",
        "Roles": Array [
          Object {
            "Ref": "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubDiscoveryD6EEC2B8": Object {
      "DependsOn": Array [
        "ConstructHubDiscoveryServiceRoleDefaultPolicy9D5F91B3",
        "ConstructHubDiscoveryServiceRole1B3CFF96",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dS3Bucket7B3413EA",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dS3VersionKeyE2914469",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters0dfb0b3b18599bad760f45b02537f770c6d07bfba2daa5407d82b6306d92963dS3VersionKeyE2914469",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Description": "Periodically query npm.js index for new construct libraries",
        "Environment": Object {
          "Variables": Object {
            "BUCKET_NAME": Object {
              "Ref": "ConstructHubDiscoveryStagingBucket1F2F7AE8",
            },
            "QUEUE_URL": Object {
              "Ref": "ConstructHubIngestionQueue1AD94CA3",
            },
          },
        },
        "Handler": "index.handler",
        "MemorySize": 10240,
        "ReservedConcurrentExecutions": 1,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubDiscoveryServiceRole1B3CFF96",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubDiscoveryErrorsAlarmDEA85148": Object {
      "Properties": Object {
        "AlarmDescription": "The discovery function (on npmjs.com) failed to run",
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubDiscoveryD6EEC2B8",
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 900,
        "Statistic": "Sum",
        "Threshold": 1,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubDiscoveryNoInvocationsAlarm6F5E3A99": Object {
      "Properties": Object {
        "AlarmDescription": "The discovery function (on npmjs.com) is not running as scheduled",
        "ComparisonOperator": "LessThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubDiscoveryD6EEC2B8",
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "Invocations",
        "Namespace": "AWS/Lambda",
        "Period": 900,
        "Statistic": "Sum",
        "Threshold": 1,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubDiscoveryScheduleRule90EE2E2A": Object {
      "Properties": Object {
        "ScheduleExpression": "rate(15 minutes)",
        "State": "ENABLED",
        "Targets": Array [
          Object {
            "Arn": Object {
              "Fn::GetAtt": Array [
                "ConstructHubDiscoveryD6EEC2B8",
                "Arn",
              ],
            },
            "Id": "Target0",
          },
        ],
      },
      "Type": "AWS::Events::Rule",
    },
    "ConstructHubDiscoveryScheduleRuleAllowEventRuleTestConstructHubDiscovery5714D5BB9D860B10": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubDiscoveryD6EEC2B8",
            "Arn",
          ],
        },
        "Principal": "events.amazonaws.com",
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubDiscoveryScheduleRule90EE2E2A",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubDiscoveryServiceRole1B3CFF96": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubDiscoveryServiceRoleDefaultPolicy9D5F91B3": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubDiscoveryStagingBucket1F2F7AE8",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubDiscoveryStagingBucket1F2F7AE8",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "sqs:SendMessage",
                "sqs:GetQueueAttributes",
                "sqs:GetQueueUrl",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubIngestionQueue1AD94CA3",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubDiscoveryServiceRoleDefaultPolicy9D5F91B3",
        "Roles": Array [
          Object {
            "Ref": "ConstructHubDiscoveryServiceRole1B3CFF96",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubDiscoveryStagingBucket1F2F7AE8": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "LifecycleConfiguration": Object {
          "Rules": Array [
            Object {
              "ExpirationInDays": 30,
              "Prefix": "staged/",
              "Status": "Enabled",
            },
          ],
        },
        "PublicAccessBlockConfiguration": Object {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true,
        },
      },
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
    },
    "ConstructHubIngestion407909CE": Object {
      "DependsOn": Array [
        "ConstructHubIngestionServiceRoleDefaultPolicyC0D2B6F2",
        "ConstructHubIngestionServiceRole6380BAB6",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236S3BucketD05214B3",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236S3VersionKey29F1A337",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters3e02956cc32cf10dd2b4bc9b8ce10b11fd2bf864ae97f32e5d3df6b7284d0236S3VersionKey29F1A337",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "DeadLetterConfig": Object {
          "TargetArn": Object {
            "Fn::GetAtt": Array [
              "ConstructHubIngestionDeadLetterQueueFC1025F8",
              "Arn",
            ],
          },
        },
        "Description": "Ingests new package versions into the Construct Hub",
        "Environment": Object {
          "Variables": Object {
            "BUCKET_NAME": Object {
              "Ref": "ConstructHubPackageDataDC5EF35E",
            },
          },
        },
        "Handler": "index.handler",
        "MemorySize": 10240,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubIngestionServiceRole6380BAB6",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubIngestionDLQAlarm83BD1903": Object {
      "Properties": Object {
        "AlarmDescription": "The ingestion function failed for one or more packages",
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "Dimensions": Array [
          Object {
            "Name": "QueueName",
            "Value": Object {
              "Fn::GetAtt": Array [
                "ConstructHubIngestionDeadLetterQueueFC1025F8",
                "QueueName",
              ],
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "ApproximateNumberOfMessagesVisible",
        "Namespace": "AWS/SQS",
        "Period": 300,
        "Statistic": "Maximum",
        "Threshold": 1,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubIngestionDeadLetterQueueFC1025F8": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "MessageRetentionPeriod": 1209600,
      },
      "Type": "AWS::SQS::Queue",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubIngestionEventInvokeConfig47AAD616": Object {
      "Properties": Object {
        "FunctionName": Object {
          "Ref": "ConstructHubIngestion407909CE",
        },
        "MaximumRetryAttempts": 2,
        "Qualifier": "$LATEST",
      },
      "Type": "AWS::Lambda::EventInvokeConfig",
    },
    "ConstructHubIngestionQueue1AD94CA3": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "KmsMasterKeyId": "alias/aws/sqs",
        "VisibilityTimeout": 900,
      },
      "Type": "AWS::SQS::Queue",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubIngestionServiceRole6380BAB6": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubIngestionServiceRoleDefaultPolicyC0D2B6F2": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sqs:SendMessage",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubIngestionDeadLetterQueueFC1025F8",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "sqs:ReceiveMessage",
                "sqs:ChangeMessageVisibility",
                "sqs:GetQueueUrl",
                "sqs:DeleteMessage",
                "sqs:GetQueueAttributes",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubIngestionQueue1AD94CA3",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubDiscoveryStagingBucket1F2F7AE8",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubDiscoveryStagingBucket1F2F7AE8",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubIngestionServiceRoleDefaultPolicyC0D2B6F2",
        "Roles": Array [
          Object {
            "Ref": "ConstructHubIngestionServiceRole6380BAB6",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubIngestionSqsEventSourceTestConstructHubIngestionQueue165B81E2C095FF2A": Object {
      "Properties": Object {
        "BatchSize": 1,
        "EventSourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubIngestionQueue1AD94CA3",
            "Arn",
          ],
        },
        "FunctionName": Object {
          "Ref": "ConstructHubIngestion407909CE",
        },
      },
      "Type": "AWS::Lambda::EventSourceMapping",
    },
    "ConstructHubInventoryCanary63D899BC": Object {
      "DependsOn": Array [
        "ConstructHubInventoryCanaryServiceRoleDefaultPolicy144783F1",
        "ConstructHubInventoryCanaryServiceRole7684EDDE",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784S3BucketE5876F15",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784S3VersionKey267A8045",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters97e6563aeb743805ef5d4bbbbe29d6b3bb28c0544c9cca24a203de835bd21784S3VersionKey267A8045",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Description": "[ConstructHub/Inventory] A canary that periodically inspects the list of indexed packages",
        "Environment": Object {
          "Variables": Object {
            "BUCKET_NAME": Object {
              "Ref": "ConstructHubPackageDataDC5EF35E",
            },
          },
        },
        "Handler": "index.handler",
        "MemorySize": 10240,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubInventoryCanaryServiceRole7684EDDE",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubInventoryCanaryScheduleRule79F2F8D8": Object {
      "DependsOn": Array [
        "ConstructHubInventoryCanaryServiceRoleDefaultPolicy144783F1",
      ],
      "Properties": Object {
        "ScheduleExpression": "rate(5 minutes)",
        "State": "ENABLED",
        "Targets": Array [
          Object {
            "Arn": Object {
              "Fn::GetAtt": Array [
                "ConstructHubInventoryCanary63D899BC",
                "Arn",
              ],
            },
            "Id": "Target0",
          },
        ],
      },
      "Type": "AWS::Events::Rule",
    },
    "ConstructHubInventoryCanaryScheduleRuleAllowEventRuleTestConstructHubInventoryCanary54F5B7AC7EBA7AB2": Object {
      "DependsOn": Array [
        "ConstructHubInventoryCanaryServiceRoleDefaultPolicy144783F1",
      ],
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubInventoryCanary63D899BC",
            "Arn",
          ],
        },
        "Principal": "events.amazonaws.com",
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubInventoryCanaryScheduleRule79F2F8D8",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubInventoryCanaryServiceRole7684EDDE": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubInventoryCanaryServiceRoleDefaultPolicy144783F1": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubInventoryCanaryServiceRoleDefaultPolicy144783F1",
        "Roles": Array [
          Object {
            "Ref": "ConstructHubInventoryCanaryServiceRole7684EDDE",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubMonitoringDashboard78E057C8": Object {
      "Properties": Object {
        "DashboardBody": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"widgets\\":[{\\"type\\":\\"metric\\",\\"width\\":24,\\"height\\":6,\\"x\\":0,\\"y\\":0,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"ACM Certificate Expiry\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"annotations\\":{\\"alarms\\":[\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubWebAppExpirationMonitorACMAlarm0B479A12",
                  "Arn",
                ],
              },
              "\\"]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":24,\\"height\\":6,\\"x\\":0,\\"y\\":6,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Endpoint Certificate Expiry\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"annotations\\":{\\"alarms\\":[\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubWebAppExpirationMonitorEndpointAlarmAA7AF160",
                  "Arn",
                ],
              },
              "\\"]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":24,\\"height\\":6,\\"x\\":0,\\"y\\":12,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Home Page Canary\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"annotations\\":{\\"alarms\\":[\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubMonitoringWebCanaryHomePageErrorsE7BB4002",
                  "Arn",
                ],
              },
              "\\"]},\\"yAxis\\":{}}}]}",
            ],
          ],
        },
        "DashboardName": "construct-hub-high-severity",
      },
      "Type": "AWS::CloudWatch::Dashboard",
    },
    "ConstructHubMonitoringWatchfulDashboardB8493D55": Object {
      "Properties": Object {
        "DashboardBody": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"widgets\\":[{\\"type\\":\\"text\\",\\"width\\":24,\\"height\\":2,\\"x\\":0,\\"y\\":0,\\"properties\\":{\\"markdown\\":\\"# Ingestion Function\\\\n\\\\n[button:AWS Lambda Console](https://console.aws.amazon.com/lambda/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#/functions/",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              "?tab=graph) [button:CloudWatch Logs](https://console.aws.amazon.com/cloudwatch/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#logEventViewer:group=/aws/lambda/",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              ")\\"}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":0,\\"y\\":2,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Invocations/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Invocations\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":6,\\"y\\":2,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Errors/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Errors\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Errors > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":12,\\"y\\":2,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Throttles/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Throttles\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Throttles > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":18,\\"y\\":2,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Duration/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Duration\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubIngestion407909CE",
              },
              "\\",{\\"label\\":\\"p99\\",\\"stat\\":\\"p99\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"p99 > 720000 for 3 datapoints within 15 minutes\\",\\"value\\":720000,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"text\\",\\"width\\":24,\\"height\\":2,\\"x\\":0,\\"y\\":8,\\"properties\\":{\\"markdown\\":\\"# Discovery Function\\\\n\\\\n[button:AWS Lambda Console](https://console.aws.amazon.com/lambda/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#/functions/",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              "?tab=graph) [button:CloudWatch Logs](https://console.aws.amazon.com/cloudwatch/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#logEventViewer:group=/aws/lambda/",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              ")\\"}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":0,\\"y\\":10,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Invocations/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Invocations\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":6,\\"y\\":10,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Errors/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Errors\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Errors > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":12,\\"y\\":10,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Throttles/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Throttles\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Throttles > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":18,\\"y\\":10,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Duration/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Duration\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubDiscoveryD6EEC2B8",
              },
              "\\",{\\"label\\":\\"p99\\",\\"stat\\":\\"p99\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"p99 > 720000 for 3 datapoints within 15 minutes\\",\\"value\\":720000,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"text\\",\\"width\\":24,\\"height\\":2,\\"x\\":0,\\"y\\":16,\\"properties\\":{\\"markdown\\":\\"# Transliterator Function\\\\n\\\\n[button:AWS Lambda Console](https://console.aws.amazon.com/lambda/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#/functions/",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              "?tab=graph) [button:CloudWatch Logs](https://console.aws.amazon.com/cloudwatch/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#logEventViewer:group=/aws/lambda/",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              ")\\"}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":0,\\"y\\":18,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Invocations/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Invocations\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":6,\\"y\\":18,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Errors/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Errors\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Errors > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":12,\\"y\\":18,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Throttles/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Throttles\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Throttles > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":18,\\"y\\":18,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Duration/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Duration\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
              "\\",{\\"label\\":\\"p99\\",\\"stat\\":\\"p99\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"p99 > 720000 for 3 datapoints within 15 minutes\\",\\"value\\":720000,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"text\\",\\"width\\":24,\\"height\\":2,\\"x\\":0,\\"y\\":24,\\"properties\\":{\\"markdown\\":\\"# Catalog Builder Function\\\\n\\\\n[button:AWS Lambda Console](https://console.aws.amazon.com/lambda/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#/functions/",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              "?tab=graph) [button:CloudWatch Logs](https://console.aws.amazon.com/cloudwatch/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#logEventViewer:group=/aws/lambda/",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              ")\\"}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":0,\\"y\\":26,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Invocations/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Invocations\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":6,\\"y\\":26,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Errors/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Errors\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Errors > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":12,\\"y\\":26,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Throttles/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Throttles\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Throttles > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":18,\\"y\\":26,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Duration/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Duration\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
              },
              "\\",{\\"label\\":\\"p99\\",\\"stat\\":\\"p99\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"p99 > 720000 for 3 datapoints within 15 minutes\\",\\"value\\":720000,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"text\\",\\"width\\":24,\\"height\\":2,\\"x\\":0,\\"y\\":32,\\"properties\\":{\\"markdown\\":\\"# Inventory Canary\\\\n\\\\n[button:AWS Lambda Console](https://console.aws.amazon.com/lambda/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#/functions/",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              "?tab=graph) [button:CloudWatch Logs](https://console.aws.amazon.com/cloudwatch/home?region=",
              Object {
                "Ref": "AWS::Region",
              },
              "#logEventViewer:group=/aws/lambda/",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              ")\\"}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":0,\\"y\\":34,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Invocations/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Invocations\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":6,\\"y\\":34,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Errors/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Errors\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Errors > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":12,\\"y\\":34,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Throttles/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Throttles\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              "\\",{\\"stat\\":\\"Sum\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"Throttles > 0 for 3 datapoints within 15 minutes\\",\\"value\\":0,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}},{\\"type\\":\\"metric\\",\\"width\\":6,\\"height\\":6,\\"x\\":18,\\"y\\":34,\\"properties\\":{\\"view\\":\\"timeSeries\\",\\"title\\":\\"Duration/5min\\",\\"region\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"metrics\\":[[\\"AWS/Lambda\\",\\"Duration\\",\\"FunctionName\\",\\"",
              Object {
                "Ref": "ConstructHubInventoryCanary63D899BC",
              },
              "\\",{\\"label\\":\\"p99\\",\\"stat\\":\\"p99\\"}]],\\"annotations\\":{\\"horizontal\\":[{\\"label\\":\\"p99 > 240000 for 3 datapoints within 15 minutes\\",\\"value\\":240000,\\"yAxis\\":\\"left\\"}]},\\"yAxis\\":{}}}]}",
            ],
          ],
        },
        "DashboardName": "construct-hub",
      },
      "Type": "AWS::CloudWatch::Dashboard",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubCatalogBuilderC9A41048DurationAlarm557052D9": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "p99 latency >= 720s (80%)",
        "ComparisonOperator": "GreaterThanThreshold",
        "EvaluationPeriods": 3,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": "p99",
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
                    },
                  },
                ],
                "MetricName": "Duration",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "p99",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 720000,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubCatalogBuilderC9A41048ErrorsAlarmF91F07CD": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 errors per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubCatalogBuilderC9A41048ThrottlesAlarm2A5B0492": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 throttles per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubCatalogBuilder5A9DE4AF",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Throttles",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubDiscovery5714D5BBDurationAlarm5CFE5B52": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "p99 latency >= 720s (80%)",
        "ComparisonOperator": "GreaterThanThreshold",
        "EvaluationPeriods": 3,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": "p99",
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubDiscoveryD6EEC2B8",
                    },
                  },
                ],
                "MetricName": "Duration",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "p99",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 720000,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubDiscovery5714D5BBErrorsAlarm373566EE": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 errors per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubDiscoveryD6EEC2B8",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubDiscovery5714D5BBThrottlesAlarm261A4778": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 throttles per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubDiscoveryD6EEC2B8",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Throttles",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubIngestionAE667A08DurationAlarm8C97ADAD": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "p99 latency >= 720s (80%)",
        "ComparisonOperator": "GreaterThanThreshold",
        "EvaluationPeriods": 3,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": "p99",
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubIngestion407909CE",
                    },
                  },
                ],
                "MetricName": "Duration",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "p99",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 720000,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubIngestionAE667A08ErrorsAlarm76E1369B": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 errors per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubIngestion407909CE",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubIngestionAE667A08ThrottlesAlarm2CD0B31C": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 throttles per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubIngestion407909CE",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Throttles",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubInventoryCanary54F5B7ACDurationAlarm2B1DCEF6": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "p99 latency >= 240s (80%)",
        "ComparisonOperator": "GreaterThanThreshold",
        "EvaluationPeriods": 3,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": "p99",
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubInventoryCanary63D899BC",
                    },
                  },
                ],
                "MetricName": "Duration",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "p99",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 240000,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubInventoryCanary54F5B7ACErrorsAlarm2DCA11C4": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 errors per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubInventoryCanary63D899BC",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubInventoryCanary54F5B7ACThrottlesAlarm0D677953": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 throttles per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubInventoryCanary63D899BC",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Throttles",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubTransliterator3B0A6087DurationAlarm0D60D33F": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "p99 latency >= 720s (80%)",
        "ComparisonOperator": "GreaterThanThreshold",
        "EvaluationPeriods": 3,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": "p99",
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubTransliterator9C48708A",
                    },
                  },
                ],
                "MetricName": "Duration",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "p99",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 720000,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubTransliterator3B0A6087ErrorsAlarm1EDE57BC": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 errors per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubTransliterator9C48708A",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWatchfulTestConstructHubTransliterator3B0A6087ThrottlesAlarm34A8C7C1": Object {
      "Properties": Object {
        "AlarmActions": Array [],
        "AlarmDescription": "Over 0 throttles per minute",
        "ComparisonOperator": "GreaterThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "FunctionName",
            "Value": Object {
              "Ref": "ConstructHubTransliterator9C48708A",
            },
          },
        ],
        "EvaluationPeriods": 3,
        "MetricName": "Throttles",
        "Namespace": "AWS/Lambda",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 0,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWebCanaryHomePageErrorsE7BB4002": Object {
      "Properties": Object {
        "AlarmActions": Array [
          "arn:aws:sns:us-east-1:123456789012:mystack-mytopic-NZJ5JSMVGFIE",
        ],
        "AlarmDescription": Object {
          "Fn::Join": Array [
            "",
            Array [
              "80% error rate for https://",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubWebAppDistribution1F181DC9",
                  "DomainName",
                ],
              },
              " (Home Page)",
            ],
          ],
        },
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "EvaluationPeriods": 1,
        "Metrics": Array [
          Object {
            "Id": "m1",
            "Label": Object {
              "Fn::Join": Array [
                "",
                Array [
                  "https://",
                  Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubWebAppDistribution1F181DC9",
                      "DomainName",
                    ],
                  },
                  " Errors",
                ],
              ],
            },
            "MetricStat": Object {
              "Metric": Object {
                "Dimensions": Array [
                  Object {
                    "Name": "FunctionName",
                    "Value": Object {
                      "Ref": "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionF27ADDC8",
                    },
                  },
                ],
                "MetricName": "Errors",
                "Namespace": "AWS/Lambda",
              },
              "Period": 300,
              "Stat": "Sum",
            },
            "ReturnData": true,
          },
        ],
        "Threshold": 4,
        "TreatMissingData": "breaching",
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionF27ADDC8": Object {
      "DependsOn": Array [
        "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionServiceRole9AAAD93C",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5S3BucketFA2341B6",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5S3VersionKeyB4EE9C49",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters59be5a60739e4f0f9b881492bce41ccffa8d47d16b0a4d640db1bb8200f48bd5S3VersionKeyB4EE9C49",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Description": Object {
          "Fn::Join": Array [
            "",
            Array [
              "HTTP GET https://",
              Object {
                "Fn::GetAtt": Array [
                  "ConstructHubWebAppDistribution1F181DC9",
                  "DomainName",
                ],
              },
              ": Home Page",
            ],
          ],
        },
        "Environment": Object {
          "Variables": Object {
            "URL": Object {
              "Fn::Join": Array [
                "",
                Array [
                  "https://",
                  Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubWebAppDistribution1F181DC9",
                      "DomainName",
                    ],
                  },
                ],
              ],
            },
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionServiceRole9AAAD93C",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionServiceRole9AAAD93C": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubMonitoringWebCanaryHomePageRuleAllowEventRuleTestConstructHubMonitoringWebCanaryHomePageHttpGetFunction941819C9E47F90EE": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionF27ADDC8",
            "Arn",
          ],
        },
        "Principal": "events.amazonaws.com",
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubMonitoringWebCanaryHomePageRuleE14F9F4E",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubMonitoringWebCanaryHomePageRuleE14F9F4E": Object {
      "Properties": Object {
        "ScheduleExpression": "rate(1 minute)",
        "State": "ENABLED",
        "Targets": Array [
          Object {
            "Arn": Object {
              "Fn::GetAtt": Array [
                "ConstructHubMonitoringWebCanaryHomePageHttpGetFunctionF27ADDC8",
                "Arn",
              ],
            },
            "Id": "Target0",
          },
        ],
      },
      "Type": "AWS::Events::Rule",
    },
    "ConstructHubPackageDataAllowBucketNotificationsToTestConstructHubCatalogBuilderC9A41048952FCDC8": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubCatalogBuilder5A9DE4AF",
            "Arn",
          ],
        },
        "Principal": "s3.amazonaws.com",
        "SourceAccount": Object {
          "Ref": "AWS::AccountId",
        },
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubPackageDataDC5EF35E",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubPackageDataAllowBucketNotificationsToTestConstructHubTransliterator3B0A6087EA339303": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubTransliterator9C48708A",
            "Arn",
          ],
        },
        "Principal": "s3.amazonaws.com",
        "SourceAccount": Object {
          "Ref": "AWS::AccountId",
        },
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubPackageDataDC5EF35E",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubPackageDataDC5EF35E": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "BucketEncryption": Object {
          "ServerSideEncryptionConfiguration": Array [
            Object {
              "ServerSideEncryptionByDefault": Object {
                "SSEAlgorithm": "AES256",
              },
            },
          ],
        },
        "LifecycleConfiguration": Object {
          "Rules": Array [
            Object {
              "AbortIncompleteMultipartUpload": Object {
                "DaysAfterInitiation": 1,
              },
              "Status": "Enabled",
            },
            Object {
              "NoncurrentVersionTransitions": Array [
                Object {
                  "StorageClass": "STANDARD_IA",
                  "TransitionInDays": 31,
                },
              ],
              "Status": "Enabled",
            },
            Object {
              "NoncurrentVersionExpirationInDays": 90,
              "Status": "Enabled",
            },
          ],
        },
        "PublicAccessBlockConfiguration": Object {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true,
        },
        "VersioningConfiguration": Object {
          "Status": "Enabled",
        },
      },
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
    },
    "ConstructHubPackageDataNotifications81B45141": Object {
      "DependsOn": Array [
        "ConstructHubPackageDataAllowBucketNotificationsToTestConstructHubCatalogBuilderC9A41048952FCDC8",
        "ConstructHubPackageDataAllowBucketNotificationsToTestConstructHubTransliterator3B0A6087EA339303",
      ],
      "Properties": Object {
        "BucketName": Object {
          "Ref": "ConstructHubPackageDataDC5EF35E",
        },
        "Managed": true,
        "NotificationConfiguration": Object {
          "LambdaFunctionConfigurations": Array [
            Object {
              "Events": Array [
                "s3:ObjectCreated:*",
              ],
              "Filter": Object {
                "Key": Object {
                  "FilterRules": Array [
                    Object {
                      "Name": "suffix",
                      "Value": "/package.tgz",
                    },
                    Object {
                      "Name": "prefix",
                      "Value": "data/",
                    },
                  ],
                },
              },
              "LambdaFunctionArn": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubTransliterator9C48708A",
                  "Arn",
                ],
              },
            },
            Object {
              "Events": Array [
                "s3:ObjectCreated:*",
              ],
              "Filter": Object {
                "Key": Object {
                  "FilterRules": Array [
                    Object {
                      "Name": "suffix",
                      "Value": "/assembly.json",
                    },
                    Object {
                      "Name": "prefix",
                      "Value": "data/",
                    },
                  ],
                },
              },
              "LambdaFunctionArn": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCatalogBuilder5A9DE4AF",
                  "Arn",
                ],
              },
            },
          ],
        },
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "BucketNotificationsHandler050a0587b7544547bf325f094a3db8347ECC3691",
            "Arn",
          ],
        },
      },
      "Type": "Custom::S3BucketNotifications",
    },
    "ConstructHubPackageDataPolicy4615475A": Object {
      "Properties": Object {
        "Bucket": Object {
          "Ref": "ConstructHubPackageDataDC5EF35E",
        },
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "s3:GetObject",
              "Effect": "Allow",
              "Principal": Object {
                "CanonicalUser": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubWebAppDistributionOrigin2S3OriginDA7E7FF4",
                    "S3CanonicalUserId",
                  ],
                },
              },
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    Object {
                      "Fn::GetAtt": Array [
                        "ConstructHubPackageDataDC5EF35E",
                        "Arn",
                      ],
                    },
                    "/*",
                  ],
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::S3::BucketPolicy",
    },
    "ConstructHubTransliterator9C48708A": Object {
      "DependsOn": Array [
        "ConstructHubTransliteratorServiceRoleDefaultPolicyB9C4BE06",
        "ConstructHubTransliteratorServiceRole0F8A20C8",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaS3Bucket03A867A5",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaS3VersionKeyC53D0DC5",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersba4444222fa05047fe67aa68ca915baaff47de5d3d8c063edadb5b7146b892eaS3VersionKeyC53D0DC5",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "DeadLetterConfig": Object {
          "TargetArn": Object {
            "Fn::GetAtt": Array [
              "ConstructHubTransliteratorDeadLetterQueue5544BC9A",
              "Arn",
            ],
          },
        },
        "Description": "Creates transliterated assemblies from jsii-enabled npm packages",
        "Environment": Object {
          "Variables": Object {
            "CODE_ARTIFACT_API_ENDPOINT": Object {
              "Fn::Select": Array [
                1,
                Object {
                  "Fn::Split": Array [
                    ":",
                    Object {
                      "Fn::Select": Array [
                        0,
                        Object {
                          "Fn::GetAtt": Array [
                            "ConstructHubVPCCodeArtifactAPI954CFDE1",
                            "DnsEntries",
                          ],
                        },
                      ],
                    },
                  ],
                },
              ],
            },
            "CODE_ARTIFACT_DOMAIN_NAME": Object {
              "Fn::GetAtt": Array [
                "ConstructHubCodeArtifact1188409E",
                "DomainName",
              ],
            },
            "CODE_ARTIFACT_DOMAIN_OWNER": Object {
              "Fn::GetAtt": Array [
                "ConstructHubCodeArtifact1188409E",
                "DomainOwner",
              ],
            },
            "CODE_ARTIFACT_REPOSITORY_ENDPOINT": Object {
              "Fn::GetAtt": Array [
                "ConstructHubCodeArtifactGetEndpoint9A458FEF",
                "repositoryEndpoint",
              ],
            },
          },
        },
        "Handler": "index.handler",
        "MemorySize": 10240,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubTransliteratorServiceRole0F8A20C8",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 900,
        "VpcConfig": Object {
          "SecurityGroupIds": Array [
            Object {
              "Fn::GetAtt": Array [
                "ConstructHubTransliteratorSecurityGroup575788E8",
                "GroupId",
              ],
            },
          ],
          "SubnetIds": Array [
            Object {
              "Ref": "ConstructHubVPCIsolatedSubnet1SubnetEA28FD1A",
            },
            Object {
              "Ref": "ConstructHubVPCIsolatedSubnet2Subnet483D4302",
            },
          ],
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubTransliteratorDLQAlarmA93C182B": Object {
      "Properties": Object {
        "AlarmDescription": "The transliteration function failed for one or more packages",
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "Dimensions": Array [
          Object {
            "Name": "QueueName",
            "Value": Object {
              "Fn::GetAtt": Array [
                "ConstructHubTransliteratorDeadLetterQueue5544BC9A",
                "QueueName",
              ],
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "ApproximateNumberOfMessagesVisible",
        "Namespace": "AWS/SQS",
        "Period": 300,
        "Statistic": "Maximum",
        "Threshold": 1,
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubTransliteratorDeadLetterQueue5544BC9A": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "MessageRetentionPeriod": 1209600,
      },
      "Type": "AWS::SQS::Queue",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubTransliteratorEventInvokeConfig999CBA91": Object {
      "Properties": Object {
        "FunctionName": Object {
          "Ref": "ConstructHubTransliterator9C48708A",
        },
        "MaximumRetryAttempts": 2,
        "Qualifier": "$LATEST",
      },
      "Type": "AWS::Lambda::EventInvokeConfig",
    },
    "ConstructHubTransliteratorLogRetention25A9F47C": Object {
      "Properties": Object {
        "LogGroupName": Object {
          "Fn::Join": Array [
            "",
            Array [
              "/aws/lambda/",
              Object {
                "Ref": "ConstructHubTransliterator9C48708A",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A",
            "Arn",
          ],
        },
      },
      "Type": "Custom::LogRetention",
    },
    "ConstructHubTransliteratorSecurityGroup575788E8": Object {
      "Properties": Object {
        "GroupDescription": "Automatic security group for Lambda Function TestConstructHubTransliterator3B0A6087",
        "SecurityGroupEgress": Array [
          Object {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::SecurityGroup",
    },
    "ConstructHubTransliteratorServiceRole0F8A20C8": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubTransliteratorServiceRoleDefaultPolicyB9C4BE06": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sqs:SendMessage",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubTransliteratorDeadLetterQueue5544BC9A",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": "sts:GetServiceBearerToken",
              "Condition": Object {
                "StringEquals": Object {
                  "sts:AWSServiceName": "codeartifact.amazonaws.com",
                },
              },
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": Array [
                "codeartifact:GetAuthorizationToken",
                "codeartifact:GetRepositoryEndpoint",
                "codeartifact:ReadFromRepository",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubCodeArtifactDomainFC30B796",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubCodeArtifact1188409E",
                    "Arn",
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/data/*/package.tgz",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/data/*/assembly-*.json",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ConstructHubTransliteratorServiceRoleDefaultPolicyB9C4BE06",
        "Roles": Array [
          Object {
            "Ref": "ConstructHubTransliteratorServiceRole0F8A20C8",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ConstructHubVPC16ECCEA2": Object {
      "Properties": Object {
        "CidrBlock": "10.0.0.0/16",
        "EnableDnsHostnames": true,
        "EnableDnsSupport": true,
        "InstanceTenancy": "default",
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC",
          },
        ],
      },
      "Type": "AWS::EC2::VPC",
    },
    "ConstructHubVPCCodeArtifactAPI954CFDE1": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:GetServiceBearerToken",
              "Condition": Object {
                "StringEquals": Object {
                  "sts:AWSServiceName": "codeartifact.amazonaws.com",
                },
              },
              "Effect": "Allow",
              "Principal": Object {
                "AWS": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubTransliteratorServiceRole0F8A20C8",
                    "Arn",
                  ],
                },
              },
              "Resource": "*",
            },
            Object {
              "Action": Array [
                "codeartifact:GetAuthorizationToken",
                "codeartifact:GetRepositoryEndpoint",
              ],
              "Effect": "Allow",
              "Principal": Object {
                "AWS": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubTransliteratorServiceRole0F8A20C8",
                    "Arn",
                  ],
                },
              },
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubCodeArtifactDomainFC30B796",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubCodeArtifact1188409E",
                    "Arn",
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PrivateDnsEnabled": false,
        "SecurityGroupIds": Array [
          Object {
            "Fn::GetAtt": Array [
              "ConstructHubVPCCodeArtifactAPISecurityGroupBE06BEF9",
              "GroupId",
            ],
          },
        ],
        "ServiceName": Object {
          "Fn::Join": Array [
            "",
            Array [
              "com.amazonaws.",
              Object {
                "Ref": "AWS::Region",
              },
              ".codeartifact.api",
            ],
          ],
        },
        "SubnetIds": Array [
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet1SubnetEA28FD1A",
          },
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet2Subnet483D4302",
          },
        ],
        "VpcEndpointType": "Interface",
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::VPCEndpoint",
    },
    "ConstructHubVPCCodeArtifactAPISecurityGroupBE06BEF9": Object {
      "Properties": Object {
        "GroupDescription": "Test/ConstructHub/VPC/CodeArtifact.API/SecurityGroup",
        "SecurityGroupEgress": Array [
          Object {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1",
          },
        ],
        "SecurityGroupIngress": Array [
          Object {
            "CidrIp": Object {
              "Fn::GetAtt": Array [
                "ConstructHubVPC16ECCEA2",
                "CidrBlock",
              ],
            },
            "Description": Object {
              "Fn::Join": Array [
                "",
                Array [
                  "from ",
                  Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubVPC16ECCEA2",
                      "CidrBlock",
                    ],
                  },
                  ":443",
                ],
              ],
            },
            "FromPort": 443,
            "IpProtocol": "tcp",
            "ToPort": 443,
          },
        ],
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::SecurityGroup",
    },
    "ConstructHubVPCCodeArtifactBD6E076F": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "codeartifact:ReadFromRepository",
              "Effect": "Allow",
              "Principal": Object {
                "AWS": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubTransliteratorServiceRole0F8A20C8",
                    "Arn",
                  ],
                },
              },
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubCodeArtifact1188409E",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PrivateDnsEnabled": true,
        "SecurityGroupIds": Array [
          Object {
            "Fn::GetAtt": Array [
              "ConstructHubVPCCodeArtifactSecurityGroupBCADE40D",
              "GroupId",
            ],
          },
        ],
        "ServiceName": Object {
          "Fn::Join": Array [
            "",
            Array [
              "com.amazonaws.",
              Object {
                "Ref": "AWS::Region",
              },
              ".codeartifact.repositories",
            ],
          ],
        },
        "SubnetIds": Array [
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet1SubnetEA28FD1A",
          },
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet2Subnet483D4302",
          },
        ],
        "VpcEndpointType": "Interface",
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::VPCEndpoint",
    },
    "ConstructHubVPCCodeArtifactSecurityGroupBCADE40D": Object {
      "Properties": Object {
        "GroupDescription": "Test/ConstructHub/VPC/CodeArtifact/SecurityGroup",
        "SecurityGroupEgress": Array [
          Object {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1",
          },
        ],
        "SecurityGroupIngress": Array [
          Object {
            "CidrIp": Object {
              "Fn::GetAtt": Array [
                "ConstructHubVPC16ECCEA2",
                "CidrBlock",
              ],
            },
            "Description": Object {
              "Fn::Join": Array [
                "",
                Array [
                  "from ",
                  Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubVPC16ECCEA2",
                      "CidrBlock",
                    ],
                  },
                  ":443",
                ],
              ],
            },
            "FromPort": 443,
            "IpProtocol": "tcp",
            "ToPort": 443,
          },
        ],
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::SecurityGroup",
    },
    "ConstructHubVPCIsolatedSubnet1RouteTable750E6F36": Object {
      "Properties": Object {
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC/IsolatedSubnet1",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::RouteTable",
    },
    "ConstructHubVPCIsolatedSubnet1RouteTableAssociation3F8E4C37": Object {
      "Properties": Object {
        "RouteTableId": Object {
          "Ref": "ConstructHubVPCIsolatedSubnet1RouteTable750E6F36",
        },
        "SubnetId": Object {
          "Ref": "ConstructHubVPCIsolatedSubnet1SubnetEA28FD1A",
        },
      },
      "Type": "AWS::EC2::SubnetRouteTableAssociation",
    },
    "ConstructHubVPCIsolatedSubnet1SubnetEA28FD1A": Object {
      "Properties": Object {
        "AvailabilityZone": Object {
          "Fn::Select": Array [
            0,
            Object {
              "Fn::GetAZs": "",
            },
          ],
        },
        "CidrBlock": "10.0.0.0/17",
        "MapPublicIpOnLaunch": false,
        "Tags": Array [
          Object {
            "Key": "aws-cdk:subnet-name",
            "Value": "Isolated",
          },
          Object {
            "Key": "aws-cdk:subnet-type",
            "Value": "Isolated",
          },
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC/IsolatedSubnet1",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::Subnet",
    },
    "ConstructHubVPCIsolatedSubnet2RouteTable18129C5D": Object {
      "Properties": Object {
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC/IsolatedSubnet2",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::RouteTable",
    },
    "ConstructHubVPCIsolatedSubnet2RouteTableAssociationF8AD0E0F": Object {
      "Properties": Object {
        "RouteTableId": Object {
          "Ref": "ConstructHubVPCIsolatedSubnet2RouteTable18129C5D",
        },
        "SubnetId": Object {
          "Ref": "ConstructHubVPCIsolatedSubnet2Subnet483D4302",
        },
      },
      "Type": "AWS::EC2::SubnetRouteTableAssociation",
    },
    "ConstructHubVPCIsolatedSubnet2Subnet483D4302": Object {
      "Properties": Object {
        "AvailabilityZone": Object {
          "Fn::Select": Array [
            1,
            Object {
              "Fn::GetAZs": "",
            },
          ],
        },
        "CidrBlock": "10.0.128.0/17",
        "MapPublicIpOnLaunch": false,
        "Tags": Array [
          Object {
            "Key": "aws-cdk:subnet-name",
            "Value": "Isolated",
          },
          Object {
            "Key": "aws-cdk:subnet-type",
            "Value": "Isolated",
          },
          Object {
            "Key": "Name",
            "Value": "Test/ConstructHub/VPC/IsolatedSubnet2",
          },
        ],
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::Subnet",
    },
    "ConstructHubVPCS319E90CB6": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "s3:GetObject",
              "Effect": "Allow",
              "Principal": "*",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    Object {
                      "Fn::GetAtt": Array [
                        "ConstructHubCodeArtifactDescribeDomain6ABCBF4B",
                        "domain.s3BucketArn",
                      ],
                    },
                    "/*",
                  ],
                ],
              },
              "Sid": "Allow-CodeArtifact-Bucket",
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Principal": "*",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/data/*/package.tgz",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "s3:Abort*",
                "s3:DeleteObject*",
                "s3:PutObject*",
              ],
              "Effect": "Allow",
              "Principal": "*",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubPackageDataDC5EF35E",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubPackageDataDC5EF35E",
                          "Arn",
                        ],
                      },
                      "/data/*/assembly-*.json",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "RouteTableIds": Array [
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet1RouteTable750E6F36",
          },
          Object {
            "Ref": "ConstructHubVPCIsolatedSubnet2RouteTable18129C5D",
          },
        ],
        "ServiceName": Object {
          "Fn::Join": Array [
            "",
            Array [
              "com.amazonaws.",
              Object {
                "Ref": "AWS::Region",
              },
              ".s3",
            ],
          ],
        },
        "VpcEndpointType": "Gateway",
        "VpcId": Object {
          "Ref": "ConstructHubVPC16ECCEA2",
        },
      },
      "Type": "AWS::EC2::VPCEndpoint",
    },
    "ConstructHubWebAppARecord3863FF6C": Object {
      "Properties": Object {
        "AliasTarget": Object {
          "DNSName": Object {
            "Fn::GetAtt": Array [
              "ConstructHubWebAppDistribution1F181DC9",
              "DomainName",
            ],
          },
          "HostedZoneId": Object {
            "Fn::FindInMap": Array [
              "AWSCloudFrontPartitionHostedZoneIdMap",
              Object {
                "Ref": "AWS::Partition",
              },
              "zoneId",
            ],
          },
        },
        "Comment": "Created by the AWS CDK",
        "HostedZoneId": "ZONEID",
        "Name": "my.construct.hub.",
        "Type": "A",
      },
      "Type": "AWS::Route53::RecordSet",
    },
    "ConstructHubWebAppAaaaRecord5D99098B": Object {
      "Properties": Object {
        "AliasTarget": Object {
          "DNSName": Object {
            "Fn::GetAtt": Array [
              "ConstructHubWebAppDistribution1F181DC9",
              "DomainName",
            ],
          },
          "HostedZoneId": Object {
            "Fn::FindInMap": Array [
              "AWSCloudFrontPartitionHostedZoneIdMap",
              Object {
                "Ref": "AWS::Partition",
              },
              "zoneId",
            ],
          },
        },
        "Comment": "Created by the AWS CDK",
        "HostedZoneId": "ZONEID",
        "Name": "my.construct.hub.",
        "Type": "AAAA",
      },
      "Type": "AWS::Route53::RecordSet",
    },
    "ConstructHubWebAppDeployWebsiteAwsCliLayer23CFFBC1": Object {
      "Properties": Object {
        "Content": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68S3BucketAEADE8C7",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68S3VersionKeyE415415F",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameterse9882ab123687399f934da0d45effe675ecc8ce13b40cb946f3e1d6141fe8d68S3VersionKeyE415415F",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Description": "/opt/awscli/aws",
      },
      "Type": "AWS::Lambda::LayerVersion",
    },
    "ConstructHubWebAppDeployWebsiteCustomResourceE6DF98C9": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "DestinationBucketName": Object {
          "Ref": "ConstructHubWebAppWebsiteBucket4B2B9DB2",
        },
        "DistributionId": Object {
          "Ref": "ConstructHubWebAppDistribution1F181DC9",
        },
        "Prune": true,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536",
            "Arn",
          ],
        },
        "SourceBucketNames": Array [
          Object {
            "Ref": "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3Bucket7E2DA7AC",
          },
        ],
        "SourceObjectKeys": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3VersionKeyDEDF4AE1",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3VersionKeyDEDF4AE1",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        ],
      },
      "Type": "Custom::CDKBucketDeployment",
      "UpdateReplacePolicy": "Delete",
    },
    "ConstructHubWebAppDistribution1F181DC9": Object {
      "Properties": Object {
        "DistributionConfig": Object {
          "Aliases": Array [
            "my.construct.hub",
          ],
          "CacheBehaviors": Array [
            Object {
              "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
              "Compress": true,
              "FunctionAssociations": Array [
                Object {
                  "EventType": "viewer-response",
                  "FunctionARN": Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubWebAppResponseFunction4C2BF3E9",
                      "FunctionARN",
                    ],
                  },
                },
              ],
              "PathPattern": "/data/*",
              "TargetOriginId": "TestConstructHubWebAppDistributionOrigin276090F90",
              "ViewerProtocolPolicy": "allow-all",
            },
            Object {
              "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
              "Compress": true,
              "FunctionAssociations": Array [
                Object {
                  "EventType": "viewer-response",
                  "FunctionARN": Object {
                    "Fn::GetAtt": Array [
                      "ConstructHubWebAppResponseFunction4C2BF3E9",
                      "FunctionARN",
                    ],
                  },
                },
              ],
              "PathPattern": "/catalog.json",
              "TargetOriginId": "TestConstructHubWebAppDistributionOrigin276090F90",
              "ViewerProtocolPolicy": "allow-all",
            },
          ],
          "CustomErrorResponses": Array [
            Object {
              "ErrorCode": 404,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html",
            },
            Object {
              "ErrorCode": 403,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html",
            },
          ],
          "DefaultCacheBehavior": Object {
            "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
            "Compress": true,
            "FunctionAssociations": Array [
              Object {
                "EventType": "viewer-response",
                "FunctionARN": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubWebAppResponseFunction4C2BF3E9",
                    "FunctionARN",
                  ],
                },
              },
            ],
            "TargetOriginId": "TestConstructHubWebAppDistributionOrigin171FF58D3",
            "ViewerProtocolPolicy": "allow-all",
          },
          "DefaultRootObject": "index.html",
          "Enabled": true,
          "HttpVersion": "http2",
          "IPV6Enabled": true,
          "Origins": Array [
            Object {
              "DomainName": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubWebAppWebsiteBucket4B2B9DB2",
                  "RegionalDomainName",
                ],
              },
              "Id": "TestConstructHubWebAppDistributionOrigin171FF58D3",
              "S3OriginConfig": Object {
                "OriginAccessIdentity": Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "origin-access-identity/cloudfront/",
                      Object {
                        "Ref": "ConstructHubWebAppDistributionOrigin1S3Origin694AF937",
                      },
                    ],
                  ],
                },
              },
            },
            Object {
              "DomainName": Object {
                "Fn::GetAtt": Array [
                  "ConstructHubPackageDataDC5EF35E",
                  "RegionalDomainName",
                ],
              },
              "Id": "TestConstructHubWebAppDistributionOrigin276090F90",
              "S3OriginConfig": Object {
                "OriginAccessIdentity": Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "origin-access-identity/cloudfront/",
                      Object {
                        "Ref": "ConstructHubWebAppDistributionOrigin2S3OriginDA7E7FF4",
                      },
                    ],
                  ],
                },
              },
            },
          ],
          "ViewerCertificate": Object {
            "AcmCertificateArn": Object {
              "Fn::GetAtt": Array [
                "CertCertificateRequestorResource9D0836FD",
                "Arn",
              ],
            },
            "MinimumProtocolVersion": "TLSv1.2_2018",
            "SslSupportMethod": "sni-only",
          },
        },
      },
      "Type": "AWS::CloudFront::Distribution",
    },
    "ConstructHubWebAppDistributionOrigin1S3Origin694AF937": Object {
      "Properties": Object {
        "CloudFrontOriginAccessIdentityConfig": Object {
          "Comment": "Identity for TestConstructHubWebAppDistributionOrigin171FF58D3",
        },
      },
      "Type": "AWS::CloudFront::CloudFrontOriginAccessIdentity",
    },
    "ConstructHubWebAppDistributionOrigin2S3OriginDA7E7FF4": Object {
      "Properties": Object {
        "CloudFrontOriginAccessIdentityConfig": Object {
          "Comment": "Identity for TestConstructHubWebAppDistributionOrigin276090F90",
        },
      },
      "Type": "AWS::CloudFront::CloudFrontOriginAccessIdentity",
    },
    "ConstructHubWebAppExpirationMonitorACMAlarm0B479A12": Object {
      "Properties": Object {
        "AlarmActions": Array [
          "arn:aws:sns:us-east-1:123456789012:mystack-mytopic-NZJ5JSMVGFIE",
        ],
        "AlarmDescription": Object {
          "Fn::Join": Array [
            "",
            Array [
              "The ACM certificate ",
              Object {
                "Fn::GetAtt": Array [
                  "CertCertificateRequestorResource9D0836FD",
                  "Arn",
                ],
              },
              " will expire in less than 45 days!",
            ],
          ],
        },
        "ComparisonOperator": "LessThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "CertificateArn",
            "Value": Object {
              "Fn::GetAtt": Array [
                "CertCertificateRequestorResource9D0836FD",
                "Arn",
              ],
            },
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "DaysToExpiry",
        "Namespace": "AWS/CertificateManager",
        "Period": 86400,
        "Statistic": "Minimum",
        "Threshold": 45,
        "TreatMissingData": "breaching",
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubWebAppExpirationMonitorC375584C": Object {
      "DependsOn": Array [
        "ConstructHubWebAppExpirationMonitorServiceRoleCA4166B2",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters1ba28ce93db643201d8613eed4b49e8bfdbb812137021b400028887aa6cbfc21S3Bucket06D21812",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters1ba28ce93db643201d8613eed4b49e8bfdbb812137021b400028887aa6cbfc21S3VersionKey1BCE3833",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters1ba28ce93db643201d8613eed4b49e8bfdbb812137021b400028887aa6cbfc21S3VersionKey1BCE3833",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Description": "Monitors the days to expiry of the certificate used to serve my.construct.hub",
        "Environment": Object {
          "Variables": Object {
            "HTTPS_ENDPOINT": "my.construct.hub",
            "METRIC_NAME": "DaysToExpiry",
            "METRIC_NAMESPACE": "Test",
          },
        },
        "Handler": "index.handler",
        "MemorySize": 1024,
        "Role": Object {
          "Fn::GetAtt": Array [
            "ConstructHubWebAppExpirationMonitorServiceRoleCA4166B2",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ConstructHubWebAppExpirationMonitorEndpointAlarmAA7AF160": Object {
      "DependsOn": Array [
        "ConstructHubWebAppExpirationMonitorScheduleAllowEventRuleTestConstructHubWebAppExpirationMonitorA4C6D17539763086",
        "ConstructHubWebAppExpirationMonitorSchedule6EC6E0EA",
      ],
      "Properties": Object {
        "AlarmActions": Array [
          "arn:aws:sns:us-east-1:123456789012:mystack-mytopic-NZJ5JSMVGFIE",
        ],
        "AlarmDescription": "The certificate used to serve my.construct.hub will expire in less than 45 days!",
        "ComparisonOperator": "LessThanThreshold",
        "Dimensions": Array [
          Object {
            "Name": "DomainName",
            "Value": "my.construct.hub",
          },
        ],
        "EvaluationPeriods": 1,
        "MetricName": "DaysToExpiry",
        "Namespace": "Test",
        "Period": 86400,
        "Statistic": "Minimum",
        "Threshold": 45,
        "TreatMissingData": "breaching",
      },
      "Type": "AWS::CloudWatch::Alarm",
    },
    "ConstructHubWebAppExpirationMonitorSchedule6EC6E0EA": Object {
      "Properties": Object {
        "Description": Object {
          "Fn::Join": Array [
            "",
            Array [
              "Executes the ",
              Object {
                "Ref": "ConstructHubWebAppExpirationMonitorC375584C",
              },
              " function every 30 minutes",
            ],
          ],
        },
        "ScheduleExpression": "rate(30 minutes)",
        "State": "ENABLED",
        "Targets": Array [
          Object {
            "Arn": Object {
              "Fn::GetAtt": Array [
                "ConstructHubWebAppExpirationMonitorC375584C",
                "Arn",
              ],
            },
            "Id": "Target0",
          },
        ],
      },
      "Type": "AWS::Events::Rule",
    },
    "ConstructHubWebAppExpirationMonitorScheduleAllowEventRuleTestConstructHubWebAppExpirationMonitorA4C6D17539763086": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ConstructHubWebAppExpirationMonitorC375584C",
            "Arn",
          ],
        },
        "Principal": "events.amazonaws.com",
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ConstructHubWebAppExpirationMonitorSchedule6EC6E0EA",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ConstructHubWebAppExpirationMonitorServiceRoleCA4166B2": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ConstructHubWebAppResponseFunction4C2BF3E9": Object {
      "Properties": Object {
        "AutoPublish": true,
        "FunctionCode": "\\"use strict\\";
function handler(event) {
    var response = event.response;
    var headers = response.headers;
    headers['x-frame-options'] = { value: 'deny' };
    headers['x-xss-protection'] = { value: '1; mode=block' };
    headers['x-content-type-options'] = { value: 'nosniff' };
    headers['strict-transport-security'] = { value: 'max-age=47304000; includeSubDomains' };
    headers['content-security-policy'] = {
        value: 'default-src \\\\'none\\\\'; img-src \\\\'self\\\\' https://img.shields.io; script-src \\\\'self\\\\'; style-src \\\\'unsafe-inline\\\\' \\\\'self\\\\'; object-src \\\\'none\\\\'; connect-src \\\\'self\\\\'; manifest-src \\\\'self\\\\'; font-src \\\\'self\\\\'; frame-src \\\\'none\\\\'',
    };
    return response;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzcG9uc2UtZnVuY3Rpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvd2ViYXBwL3Jlc3BvbnNlLWZ1bmN0aW9uL3Jlc3BvbnNlLWZ1bmN0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFTQSxTQUFTLE9BQU8sQ0FBQyxLQUF5QjtJQUN4QyxJQUFJLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDO0lBQzlCLElBQUksT0FBTyxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUM7SUFFL0IsT0FBTyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLENBQUM7SUFDL0MsT0FBTyxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsZUFBZSxFQUFFLENBQUM7SUFDekQsT0FBTyxDQUFDLHdCQUF3QixDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLENBQUM7SUFDekQsT0FBTyxDQUFDLDJCQUEyQixDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUscUNBQXFDLEVBQUUsQ0FBQztJQUN4RixPQUFPLENBQUMseUJBQXlCLENBQUMsR0FBRztRQUNuQyxLQUFLLEVBQ0gsbU9BQW1PO0tBQ3RPLENBQUM7SUFFRixPQUFPLFFBQVEsQ0FBQztBQUNsQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW50ZXJmYWNlIENsb3VkRnJvbnRSZXNwb25zZSB7XG4gIHJlc3BvbnNlOiBhbnk7XG4gIGhlYWRlcnM6IHtcbiAgICBba2V5OiBzdHJpbmddOiB7XG4gICAgICB2YWx1ZTogc3RyaW5nO1xuICAgIH07XG4gIH07XG59XG5cbmZ1bmN0aW9uIGhhbmRsZXIoZXZlbnQ6IENsb3VkRnJvbnRSZXNwb25zZSkge1xuICB2YXIgcmVzcG9uc2UgPSBldmVudC5yZXNwb25zZTtcbiAgdmFyIGhlYWRlcnMgPSByZXNwb25zZS5oZWFkZXJzO1xuXG4gIGhlYWRlcnNbJ3gtZnJhbWUtb3B0aW9ucyddID0geyB2YWx1ZTogJ2RlbnknIH07XG4gIGhlYWRlcnNbJ3gteHNzLXByb3RlY3Rpb24nXSA9IHsgdmFsdWU6ICcxOyBtb2RlPWJsb2NrJyB9O1xuICBoZWFkZXJzWyd4LWNvbnRlbnQtdHlwZS1vcHRpb25zJ10gPSB7IHZhbHVlOiAnbm9zbmlmZicgfTtcbiAgaGVhZGVyc1snc3RyaWN0LXRyYW5zcG9ydC1zZWN1cml0eSddID0geyB2YWx1ZTogJ21heC1hZ2U9NDczMDQwMDA7IGluY2x1ZGVTdWJEb21haW5zJyB9O1xuICBoZWFkZXJzWydjb250ZW50LXNlY3VyaXR5LXBvbGljeSddID0ge1xuICAgIHZhbHVlOlxuICAgICAgJ2RlZmF1bHQtc3JjIFxcJ25vbmVcXCc7IGltZy1zcmMgXFwnc2VsZlxcJyBodHRwczovL2ltZy5zaGllbGRzLmlvOyBzY3JpcHQtc3JjIFxcJ3NlbGZcXCc7IHN0eWxlLXNyYyBcXCd1bnNhZmUtaW5saW5lXFwnIFxcJ3NlbGZcXCc7IG9iamVjdC1zcmMgXFwnbm9uZVxcJzsgY29ubmVjdC1zcmMgXFwnc2VsZlxcJzsgbWFuaWZlc3Qtc3JjIFxcJ3NlbGZcXCc7IGZvbnQtc3JjIFxcJ3NlbGZcXCc7IGZyYW1lLXNyYyBcXCdub25lXFwnJyxcbiAgfTtcblxuICByZXR1cm4gcmVzcG9uc2U7XG59XG4iXX0=",
        "FunctionConfig": Object {
          "Comment": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Ref": "AWS::Region",
                },
                "TestConstrubWebAppResponseFunction1F387BCC",
              ],
            ],
          },
          "Runtime": "cloudfront-js-1.0",
        },
        "Name": Object {
          "Fn::Join": Array [
            "",
            Array [
              Object {
                "Ref": "AWS::Region",
              },
              "TestConstrubWebAppResponseFunction1F387BCC",
            ],
          ],
        },
      },
      "Type": "AWS::CloudFront::Function",
    },
    "ConstructHubWebAppWebsiteBucket4B2B9DB2": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "PublicAccessBlockConfiguration": Object {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true,
        },
      },
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
    },
    "ConstructHubWebAppWebsiteBucketPolicy17174C06": Object {
      "Properties": Object {
        "Bucket": Object {
          "Ref": "ConstructHubWebAppWebsiteBucket4B2B9DB2",
        },
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "s3:GetObject",
              "Effect": "Allow",
              "Principal": Object {
                "CanonicalUser": Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubWebAppDistributionOrigin1S3Origin694AF937",
                    "S3CanonicalUserId",
                  ],
                },
              },
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    Object {
                      "Fn::GetAtt": Array [
                        "ConstructHubWebAppWebsiteBucket4B2B9DB2",
                        "Arn",
                      ],
                    },
                    "/*",
                  ],
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::S3::BucketPolicy",
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536": Object {
      "DependsOn": Array [
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfS3Bucket55EFA30C",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfS3VersionKey60329B70",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParametersc24b999656e4fe6c609c31bae56a1cf4717a405619c3aa6ba1bc686b8c2c86cfS3VersionKey60329B70",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Handler": "index.handler",
        "Layers": Array [
          Object {
            "Ref": "ConstructHubWebAppDeployWebsiteAwsCliLayer23CFFBC1",
          },
        ],
        "Role": Object {
          "Fn::GetAtt": Array [
            "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
            "Arn",
          ],
        },
        "Runtime": "python3.6",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":s3:::",
                      Object {
                        "Ref": "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3Bucket7E2DA7AC",
                      },
                    ],
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":s3:::",
                      Object {
                        "Ref": "AssetParametersb175d8adef3f5690da68fb639708436639a876ea84c5b74975a37cd644bc6d91S3Bucket7E2DA7AC",
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ConstructHubWebAppWebsiteBucket4B2B9DB2",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ConstructHubWebAppWebsiteBucket4B2B9DB2",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "cloudfront:GetInvalidation",
                "cloudfront:CreateInvalidation",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
        "Roles": Array [
          Object {
            "Ref": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A": Object {
      "DependsOn": Array [
        "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB",
        "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Ref": "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3Bucket4D46ABB5",
          },
          "S3Key": Object {
            "Fn::Join": Array [
              "",
              Array [
                Object {
                  "Fn::Select": Array [
                    0,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3VersionKeyB0F28861",
                        },
                      ],
                    },
                  ],
                },
                Object {
                  "Fn::Select": Array [
                    1,
                    Object {
                      "Fn::Split": Array [
                        "||",
                        Object {
                          "Ref": "AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3VersionKeyB0F28861",
                        },
                      ],
                    },
                  ],
                },
              ],
            ],
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
      },
      "Type": "AWS::Lambda::Function",
    },
    "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "logs:PutRetentionPolicy",
                "logs:DeleteRetentionPolicy",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB",
        "Roles": Array [
          Object {
            "Ref": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
  },
}
`;
